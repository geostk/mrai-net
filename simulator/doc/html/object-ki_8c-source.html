<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SIMRI3D: object-ki.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>object-ki.c</h1><a href="object-ki_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*************************************************************************</span>
00002 <span class="comment">* $Id: object-ki.c,v 1.11 2006/12/19 15:09:53 yougz Exp $</span>
00003 <span class="comment">**************************************************************************</span>
00004 <span class="comment"> This software is governed by the CeCILL  license under French law and</span>
00005 <span class="comment">  abiding by the rules of distribution of free software.  You can  use, </span>
00006 <span class="comment">  modify and/ or redistribute the software under the terms of the CeCILL</span>
00007 <span class="comment">  license as circulated by CEA, CNRS and INRIA at the following URL</span>
00008 <span class="comment">  "http://www.cecill.info". </span>
00009 <span class="comment">  </span>
00010 <span class="comment">  As a counterpart to the access to the source code and  rights to copy,</span>
00011 <span class="comment">  modify and redistribute granted by the license, users are provided only</span>
00012 <span class="comment">  with a limited warranty  and the software's author,  the holder of the</span>
00013 <span class="comment">  economic rights,  and the successive licensors  have only  limited</span>
00014 <span class="comment">  liability. </span>
00015 <span class="comment">  </span>
00016 <span class="comment">  In this respect, the user's attention is drawn to the risks associated</span>
00017 <span class="comment">  with loading,  using,  modifying and/or developing or reproducing the</span>
00018 <span class="comment">  software by the user in light of its specific status of free software,</span>
00019 <span class="comment">  that may mean  that it is complicated to manipulate,  and  that  also</span>
00020 <span class="comment">  therefore means  that it is reserved for developers  and  experienced</span>
00021 <span class="comment">  professionals having in-depth computer knowledge. Users are therefore</span>
00022 <span class="comment">  encouraged to load and test the software's suitability as regards their</span>
00023 <span class="comment">  requirements in conditions enabling the security of their systems and/or </span>
00024 <span class="comment">  data to be ensured and,  more generally, to use and operate it in the </span>
00025 <span class="comment">  same conditions as regards security. </span>
00026 <span class="comment">  </span>
00027 <span class="comment">  The fact that you are presently reading this means that you have had</span>
00028 <span class="comment">  knowledge of the CeCILL license and that you accept its terms.</span>
00029 <span class="comment">  </span>
00030 <span class="comment">  Copyright (c) CREATIS (Centre de Recherche et d'Applications en Traitement de</span>
00031 <span class="comment">  l'Image). All rights reserved. See License.txt for details.</span>
00032 <span class="comment">  </span>
00033 <span class="comment">  Version 2.0  20/12/2006</span>
00034 <span class="comment">*************************************************************************/</span>
00035 <span class="preprocessor">#include "<a class="code" href="object-ki_8h.html">object-ki.h</a>"</span>
00036 
00037 <span class="preprocessor">#include &lt;<a class="code" href="idseq_8h.html">idseq.h</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="idacr_8h.html">idacr.h</a>&gt;</span>
00039 <span class="preprocessor">#include &lt;string.h&gt;</span>
00040 <span class="preprocessor">#include &lt;<a class="code" href="idvol_8h.html">idvol.h</a>&gt;</span>
00041 <span class="preprocessor">#include "<a class="code" href="display_8h.html">display.h</a>"</span>
00042 
<a name="l00054"></a><a class="code" href="group__Object.html#ga1">00054</a> <span class="keywordtype">void</span> <a class="code" href="group__Object.html#ga1">SetObjectFieldDefault1D</a>(OBJECT3D* object,<span class="keywordtype">int</span> posy,<span class="keywordtype">int</span> posz,PPPVOLUME_FLOAT dech,<span class="keywordtype">int</span> dimx)
00055 {
00056  <span class="keywordtype">int</span> i;
00057    
00058    <span class="keywordflow">for</span>(i=0;i&lt;dimx;i++)
00059       <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;fielddefault[0][0][i]=dech[i][posy][posz];
00060 }
00061 
<a name="l00073"></a><a class="code" href="group__Object.html#ga2">00073</a> <span class="keywordtype">void</span> <a class="code" href="group__Object.html#ga2">SetObjectFieldDefault2D</a>(OBJECT3D* object,<span class="keywordtype">int</span> pos,PPPVOLUME_FLOAT dech,<span class="keywordtype">int</span> dimx,<span class="keywordtype">int</span> dimy)
00074 {
00075  <span class="keywordtype">int</span> i,j;
00076  <a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a> slice_dech=NULL;
00077  <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> slice=NULL;
00078 
00079  <span class="comment">/* visualisation of the field default slice which has been chosen */</span>
00080    slice_dech= (<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(dimx,dimy,<a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>);
00081    <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++) 
00082       slice_dech[j][i] = dech[i][j][pos];
00083 
00084    slice= (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(dimx,dimy,<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00085    <a class="code" href="imagette_8c.html#a6">IdImaRecadTo8</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)slice_dech,slice,-1.0,-1.0);
00086    <a class="code" href="group__Display.html#ga0">DisplayImage2D</a>(slice);
00087    
00088    <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++)
00089       <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;fielddefault[0][j][i]= dech[i][j][pos];
00090 
00091  <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(slice_dech);
00092  <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(slice);
00093 }
00094 
<a name="l00106"></a><a class="code" href="group__Object.html#ga3">00106</a> <span class="keywordtype">void</span> <a class="code" href="group__Object.html#ga3">SetObjectFieldDefault3D</a>(OBJECT3D * object,PPPVOLUME_FLOAT dech,<span class="keywordtype">int</span> dimx, <span class="keywordtype">int</span> dimy,<span class="keywordtype">int</span> dimz)
00107 {
00108  <span class="keywordtype">int</span> i,j,k;
00109  <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++) <span class="keywordflow">for</span>(k=0;k&lt;dimz;k++)
00110       <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;fielddefault[k][j][i]= dech[i][j][k];
00111 }
00112 
<a name="l00120"></a><a class="code" href="group__Object.html#ga0">00120</a> <span class="keywordtype">void</span> <a class="code" href="group__Object.html#ga0">SetObjectFieldDefault</a>(OBJECT3D * object,PPPVOLUME_FLOAT dech)
00121 {
00122  <span class="keywordtype">int</span> i,j,k;
00123  <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="idvol-ido_8h.html#a21">IdVolDimX</a>(dech);i++) <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="idvol-ido_8h.html#a22">IdVolDimY</a>(dech);j++) <span class="keywordflow">for</span>(k=0;k&lt;<a class="code" href="idvol-ido_8h.html#a23">IdVolDimZ</a>(dech);k++)
00124    <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;fielddefault[k][j][i]= dech[k][j][i];
00125 }
00126 
00127 
00128 <span class="comment">/**************************************************</span>
00129 <span class="comment">*  \ingroup Object</span>
00130 <span class="comment">* \brief Set the ro, t1, t2, and ki values for one point of an object</span>
00131 <span class="comment">* \param object Pointer on the object</span>
00132 <span class="comment">* \param x x coordinate of the point</span>
00133 <span class="comment">* \param y x coordinate of the point</span>
00134 <span class="comment">* \param z x coordinate of the point</span>
00135 <span class="comment">* \param ro ro value</span>
00136 <span class="comment">* \param t1 t1 value</span>
00137 <span class="comment">* \param t2 t2 value</span>
00138 <span class="comment">* \param ki susceptibility value</span>
00139 <span class="comment">**************************************************/</span>
<a name="l00140"></a><a class="code" href="object-ki_8h.html#a4">00140</a> <span class="keywordtype">void</span> <a class="code" href="object-ki_8h.html#a4">SetObjectPointSusceptibility</a>(OBJECT3D *object,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z,
00141                <span class="keywordtype">int</span> ro,<span class="keywordtype">int</span> t1,<span class="keywordtype">int</span> t2,<span class="keywordtype">int</span> ki) 
00142 {   
00143  <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;values[0][z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>] = ro;
00144  <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;values[1][z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>] = t1;
00145  <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;values[2][z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>] = t2;
00146  <a class="code" href="jmemsys_8h.html#a3">object</a>-&gt;values[3][z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>] = ki;
00147 }
00148 
<a name="l00157"></a><a class="code" href="group__Utility.html#ga5">00157</a> <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> <a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(<span class="keywordtype">int</span> x)
00158 {
00159 <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> vect;
00160 <span class="keywordtype">int</span> i;
00161 
00162 <span class="comment">/*Allocation*/</span>
00163 vect=(<a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a>) <a class="code" href="idmatric_8h.html#a47">IdVectAlloc</a>(<a class="code" href="jerror_8h.html#a52a35">x</a>,<a class="code" href="idmatric_8h.html#a25">VECT_FLOAT</a>);
00164 <span class="keywordflow">if</span> (!vect)
00165   {
00166    printf(<span class="stringliteral">"Allocation error in AllocInitVectFloat ! \n"</span>);
00167    exit(1);
00168   }
00169 
00170 <span class="comment">/*Initialisation*/</span>
00171 <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="jerror_8h.html#a52a35">x</a>;i++)
00172    vect[i]=0.0;
00173 
00174 <span class="keywordflow">return</span> vect;
00175 }
00176 
<a name="l00188"></a><a class="code" href="group__Object.html#ga6">00188</a> <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> <a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(<span class="keywordtype">char</span> *filein,PSIGNAL_FLOAT datatab)
00189 {
00190  <a class="code" href="idvol-ido_8h.html#a36">PPPVOLUME_UCHAR</a> label;
00191  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> <a class="code" href="jpeglib_8h.html#a60">data</a>;
00192  <span class="keywordtype">int</span> nx,ny,nz;
00193  <span class="keywordtype">int</span> <a class="code" href="jerror_8h.html#a52a35">x</a>,y,z;
00194 
00195  label = (<a class="code" href="idvol-ido_8h.html#a36">PPPVOLUME_UCHAR</a>) <a class="code" href="idacr_8h.html#a72">IdAcrReadFile</a>(filein,<a class="code" href="idvol-ido_8h.html#a1">VOL_UCHAR</a>);
00196  nx=<a class="code" href="idvol-ido_8h.html#a21">IdVolDimX</a>(label);
00197  ny=<a class="code" href="idvol-ido_8h.html#a22">IdVolDimY</a>(label);
00198  nz=<a class="code" href="idvol-ido_8h.html#a23">IdVolDimZ</a>(label);
00199 
00200  <a class="code" href="jpeglib_8h.html#a60">data</a>=(<a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a>)<a class="code" href="volallo_8c.html#a1">IdVolAlloc</a>(nx,ny,nz,<a class="code" href="idvol-ido_8h.html#a6">VOL_FLOAT</a>);
00201  <span class="keywordflow">for</span> (<a class="code" href="jerror_8h.html#a52a35">x</a>=0;<a class="code" href="jerror_8h.html#a52a35">x</a>&lt;nx;<a class="code" href="jerror_8h.html#a52a35">x</a>++) <span class="keywordflow">for</span> (y=0;y&lt;ny;y++) <span class="keywordflow">for</span>(z=0;z&lt;nz;z++) 
00202        <a class="code" href="jpeglib_8h.html#a60">data</a>[z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>]=datatab[label[z][y][<a class="code" href="jerror_8h.html#a52a35">x</a>]];
00203  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(label);
00204  <span class="keywordflow">return</span> <a class="code" href="jpeglib_8h.html#a60">data</a>;
00205 }
00206 
<a name="l00218"></a><a class="code" href="group__Object.html#ga7">00218</a> <a class="code" href="object_8h.html#a7">OBJECT3D</a> * <a class="code" href="group__Object.html#ga7">CreateObject3DSphereKi</a>(<span class="keywordtype">int</span> dimx, <span class="keywordtype">int</span> dimy, <span class="keywordtype">int</span> dimz)                                    
00219 {
00220  <a class="code" href="object_8h.html#a7">OBJECT3D</a> * objet;
00221  <span class="keywordtype">int</span>       nbcomp,nbparam;
00222  <span class="keywordtype">int</span>       i,j,k; 
00223  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> ro,t1,t2,ki,dech;  
00224  <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> roval,t1val,t2val,kival;
00225  <span class="keywordtype">char</span>  filelabel[80],filedech[80];
00226  filelabel[0]=<span class="charliteral">'\0'</span>;
00227  filedech[0]=<span class="charliteral">'\0'</span>;
00228 
00229  strcpy(filelabel,<span class="stringliteral">"hightresolution.vol"</span>);
00230  strcpy(filedech,<span class="stringliteral">"Defchamps.vol"</span>);
00231 
00232  nbcomp = 1;  
00233  nbparam= 4;  <span class="comment">/* ro, t1, t2 ,db */</span>
00234  objet = <a class="code" href="group__Object.html#ga10">AllocObject</a>(dimx,dimy,dimz,nbcomp,nbparam);
00235 
00236  roval=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00237  roval[0]=100;                 <span class="comment">/* region 0  */</span>
00238  roval[1]=90;                  <span class="comment">/* region 1  */</span>
00239  ro=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,roval);
00240 
00241  t1val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00242  t1val[0]=90 ;                  <span class="comment">/* region 0 */</span>
00243  t1val[1]=400;                   <span class="comment">/* region 1 */</span>
00244  t1=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t1val);
00245 
00246  t2val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00247  t2val[0]=40 ;                  <span class="comment">/* region 0 */</span>
00248  t2val[1]=50;                   <span class="comment">/* region 1 */</span>
00249  t2=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t2val);
00250 
00251  kival=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00252  kival[0]=0;               <span class="comment">/* region 0 */</span>      
00253  kival[1]=-9.05e-6;             <span class="comment">/* region 1 */</span>  
00254  ki=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,kival);
00255 
00256  <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++) <span class="keywordflow">for</span>(k=0;k&lt;dimz;k++)
00257      <a class="code" href="object-ki_8h.html#a4">SetObjectPointSusceptibility</a>(objet,i,j,k,(<span class="keywordtype">int</span>)ro[k][j][i],(<span class="keywordtype">int</span>)t1[k][j][i],(<span class="keywordtype">int</span>)t2[k][j][i],(<span class="keywordtype">int</span>)ki[k][j][i]);
00258 
00259 <span class="comment">/* Reading the field default values in a file </span>
00260 <span class="comment"> * This file has been obtained with one of the </span>
00261 <span class="comment"> * suceptibility default computation method */</span>
00262  <span class="keywordflow">if</span> (!strcmp(filedech,NULL)) 
00263    {
00264     dech = (<a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a>) <a class="code" href="idacr_8h.html#a72">IdAcrReadFile</a>(filedech,<a class="code" href="idvol-ido_8h.html#a6">VOL_FLOAT</a>);
00265     <a class="code" href="group__Object.html#ga3">SetObjectFieldDefault3D</a>(objet,dech,dimx,dimy,dimz);
00266    }
00267    <span class="keywordflow">else</span> 
00268    {
00269     printf(<span class="stringliteral">"Unable to read the field default values %s \n"</span>,filedech);
00270     exit(1);
00271    }
00272 
00273  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ro);
00274  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t1);
00275  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t2);
00276  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ki);
00277  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(dech);
00278  <span class="keywordflow">return</span>(objet);
00279 }
00280 
00281 
<a name="l00293"></a><a class="code" href="group__Object.html#ga8">00293</a> <a class="code" href="object_8h.html#a7">OBJECT3D</a> * <a class="code" href="group__Object.html#ga8">CreateObject2DCircleKi</a>(<span class="keywordtype">int</span> dimx, <span class="keywordtype">int</span> dimy)
00294 {
00295  <a class="code" href="object_8h.html#a7">OBJECT3D</a> * objet;
00296  <span class="keywordtype">int</span>       nbcomp,nbparam;
00297  <span class="keywordtype">int</span>       i,j,k;
00298  <span class="keywordtype">int</span>       z;     
00299  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> ro,t1,t2,ki,dech;  
00300  <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> roval,t1val,t2val,kival;
00301  <span class="keywordtype">char</span>   filelabel[80], filedech[80];
00302  filelabel[0]=<span class="charliteral">'\0'</span>;
00303  filedech[0]=<span class="charliteral">'\0'</span>;
00304 
00305  strcpy(filelabel,<span class="stringliteral">"../data/ki/sphere_64_10.vol"</span>);
00306  strcpy(filedech,<span class="stringliteral">"../data/ki/defchamps_sphere_64_10.vol"</span>);
00307        
00308  nbcomp = 1;  
00309  nbparam= 4;  <span class="comment">/* ro, t1, t2 ,db */</span>
00310 
00311  objet = <a class="code" href="group__Object.html#ga10">AllocObject</a>(dimx,dimy,1,nbcomp,nbparam);
00312  
00313  roval=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00314  roval[0]=1000;               <span class="comment">/* region 0 */</span>
00315  roval[1]=0;                  <span class="comment">/* region 1 */</span>
00316  ro=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,roval);
00317  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(roval);
00318 
00319  t1val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00320  t1val[0]=2000 ;                 <span class="comment">/* region 0 */</span>
00321  t1val[1]=400;                   <span class="comment">/* region 1 */</span>
00322  t1=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t1val);
00323  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t1val);
00324 
00325  t2val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00326  t2val[0]=200 ;                 <span class="comment">/* region 0 */</span>
00327  t2val[1]=50;                   <span class="comment">/* region 1 */</span>
00328  t2=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t2val);
00329  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t2val);
00330 
00331  <span class="comment">/* remplissage avec du ki */</span>
00332  kival=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00333  kival[0]=-9.05e-6;        <span class="comment">/* region 0 */</span>
00334  kival[1]=0;               <span class="comment">/* region 1 */</span>
00335  ki=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,kival);
00336  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(kival);
00337 
00338  k=0;
00339  z=dimx/2; <span class="comment">/* Chosen slice */</span> 
00340  <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++)
00341   <a class="code" href="object-ki_8h.html#a4">SetObjectPointSusceptibility</a>(objet,i,j,k,(<span class="keywordtype">int</span>)ro[z][j][i],(<span class="keywordtype">int</span>)t1[z][j][i],(<span class="keywordtype">int</span>)t2[z][j][i],(<span class="keywordtype">int</span>)ki[z][j][i]);
00342 
00343  
00344 <span class="comment">/* Reading the field default values in a file </span>
00345 <span class="comment"> * This file has been obtained with one of the </span>
00346 <span class="comment"> * suceptibility default computation method */</span>
00347  dech = (<a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a>)<a class="code" href="idacr_8h.html#a72">IdAcrReadFile</a>(filedech,<a class="code" href="idvol-ido_8h.html#a6">VOL_FLOAT</a>);
00348  <span class="keywordflow">if</span> (!dech)
00349    {
00350     printf(<span class="stringliteral">"Unable to read the field default values %s \n"</span>,filedech);
00351     exit(1);
00352    }
00353  <a class="code" href="group__Object.html#ga2">SetObjectFieldDefault2D</a>(objet,z,dech,dimx,dimy);
00354 
00355  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ro);
00356  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t1);
00357  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t2);
00358  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ki);
00359  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(dech);
00360  <span class="keywordflow">return</span>(objet);
00361 }
00362 
<a name="l00372"></a><a class="code" href="group__Object.html#ga9">00372</a> <a class="code" href="object_8h.html#a7">OBJECT3D</a> * <a class="code" href="group__Object.html#ga9">CreateObject1DSectionKi</a>(<span class="keywordtype">int</span> dimx)
00373 {
00374  <a class="code" href="object_8h.html#a7">OBJECT3D</a> * objet;
00375  <span class="keywordtype">int</span>       nbcomp,nbparam;
00376  <span class="keywordtype">int</span>       i,j,k; 
00377  <span class="keywordtype">int</span>       y,z;   
00378  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> ro,t1,t2,ki; 
00379  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> dech;
00380  <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> roval,t1val,t2val,kival;
00381  <span class="keywordtype">char</span>   filelabel[80],filedech[80];
00382  filelabel[0]=<span class="charliteral">'\0'</span>;
00383  filedech[0]=<span class="charliteral">'\0'</span>;
00384 
00385  strcpy(filelabel,<span class="stringliteral">"../data/hightresolution.vol"</span>);
00386  strcpy(filedech,<span class="stringliteral">"../data/Defchamps.vol"</span>);
00387 
00388  nbcomp = 1; 
00389  nbparam= 4;  <span class="comment">/* ro, t1, t2 ,db */</span>
00390 
00391  objet = <a class="code" href="group__Object.html#ga10">AllocObject</a>(dimx,1,1,nbcomp,nbparam);
00392  
00393  roval=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00394  roval[0]=0;                    <span class="comment">/* region 0 */</span>
00395  roval[1]=100;                  <span class="comment">/* region 1 */</span>
00396  ro=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,roval);
00397  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(roval);
00398  
00399  t1val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00400  t1val[0]=400 ;                 <span class="comment">/* region 0 */</span>
00401  t1val[1]=2000;                 <span class="comment">/* region 1 */</span>
00402  t1=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t1val);
00403  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t1val);
00404 
00405  t2val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00406  t2val[0]=50 ;                  <span class="comment">/* region 0 */</span>
00407  t2val[1]=200;                  <span class="comment">/* region 1 */</span>
00408  t2=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t2val);
00409  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t2val);
00410 
00411  kival=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00412  kival[0]=-9.05e-6;      <span class="comment">/* region 0 */</span>
00413  kival[1]=0;             <span class="comment">/* region 1 */</span>
00414  ki=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,kival);
00415  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(kival);
00416 
00417  y=dimx/2; <span class="comment">/* chosen line */</span>
00418  z=dimx/2; <span class="comment">/* chosen slice */</span> 
00419  
00420  j=0;
00421  k=0;
00422  <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) 
00423  {
00424   <a class="code" href="object-ki_8h.html#a4">SetObjectPointSusceptibility</a>(objet,i,j,k,(<span class="keywordtype">int</span>)ro[z][y][i],(<span class="keywordtype">int</span>)t1[z][y][i],(<span class="keywordtype">int</span>)t2[z][y][i],(<span class="keywordtype">int</span>)ki[z][y][i]);
00425  }
00426 
00427  <span class="comment">/* Reading the field default values in a file </span>
00428 <span class="comment"> * This file has been obtained with one of the </span>
00429 <span class="comment"> * suceptibility default computation method */</span>
00430  <span class="keywordflow">if</span> (strcmp(filedech,<span class="stringliteral">"NULL"</span>)) 
00431    {   
00432     dech = (<a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a>) <a class="code" href="idacr_8h.html#a72">IdAcrReadFile</a>(filedech,<a class="code" href="idvol-ido_8h.html#a6">VOL_FLOAT</a>);
00433     <a class="code" href="group__Object.html#ga1">SetObjectFieldDefault1D</a>(objet,y,z,dech,dimx);
00434    }
00435    <span class="keywordflow">else</span>
00436    {
00437     printf(<span class="stringliteral">"Unable to read the field default values %s \n"</span>,filedech);
00438     exit(1);
00439    }
00440  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ro);
00441  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t1);
00442  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t2);
00443  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ki);
00444  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(dech);
00445  <span class="keywordflow">return</span>(objet);
00446 }
00447 
<a name="l00459"></a><a class="code" href="group__Object.html#ga10">00459</a> <a class="code" href="object_8h.html#a7">OBJECT3D</a> * <a class="code" href="group__Object.html#ga10">CreateObject2DKi</a>(<span class="keywordtype">float</span> RoExt, <span class="keywordtype">float</span> RoInt, <span class="keywordtype">float</span> T1Ext,<span class="keywordtype">float</span> T1Int, <span class="keywordtype">float</span> T2Ext, <span class="keywordtype">float</span> T2Int, <span class="keywordtype">float</span> KiExt, <span class="keywordtype">float</span> KiInt, <span class="keywordtype">int</span> dimx, <span class="keywordtype">int</span> dimy, <span class="keywordtype">char</span> *filelabel, <span class="keywordtype">char</span> *filedech)
00460 {
00461  <a class="code" href="object_8h.html#a7">OBJECT3D</a> * objet;
00462  <span class="keywordtype">int</span>       nbcomp,nbparam;
00463  <span class="keywordtype">int</span>       i,j,k;
00464  <span class="keywordtype">int</span>       z;   
00465  <a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a> ro,t1,t2,ki,dech;  
00466  <a class="code" href="idmatric_8h.html#a93">PVECTOR_FLOAT</a> roval,t1val,t2val,kival;
00467       
00468  nbcomp = 1;  
00469  nbparam= 4;  <span class="comment">/* ro, t1, t2 ,db */</span>
00470  
00471  objet = <a class="code" href="group__Object.html#ga10">AllocObject</a>(dimx,dimy,1,nbcomp,nbparam);
00472 
00473  roval=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00474  roval[0]=RoExt;                  <span class="comment">/* region 0 */</span>
00475  roval[1]=RoInt;                  <span class="comment">/* region 1 */</span>
00476  ro=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,roval);
00477  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(roval);
00478 
00479  t1val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00480  t1val[0]=T1Ext;                  <span class="comment">/* region 0 */</span>
00481  t1val[1]=T1Int;                  <span class="comment">/* region 1 */</span>
00482  t1=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t1val);
00483  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t1val);
00484 
00485  t2val=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00486  t2val[0]=T2Ext ;                  <span class="comment">/* region 0 */</span>
00487  t2val[1]=T2Int;                   <span class="comment">/* region 1 */</span>
00488  t2=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,t2val);
00489  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(t2val);
00490 
00491  kival=<a class="code" href="group__Utility.html#ga5">AllocInitVectFloat</a>(2);
00492  kival[0]=KiExt;              <span class="comment">/* region 0 */</span> 
00493  kival[1]=KiInt;                   <span class="comment">/* region 1 */</span>
00494  ki=<a class="code" href="group__Object.html#ga6">GetParamFromDataFile</a>(filelabel,kival);
00495  <a class="code" href="idmatric_8h.html#a49">IdVectFree</a>(kival);
00496 
00497  k=0;
00498  z=dimx/2; <span class="comment">/*Slice selection*/</span>
00499  <span class="keywordflow">for</span> (i=0;i&lt;dimx;i++) <span class="keywordflow">for</span>(j=0;j&lt;dimy;j++)
00500  {    
00501   <a class="code" href="object-ki_8h.html#a4">SetObjectPointSusceptibility</a>(objet,i,j,k,(<span class="keywordtype">int</span>)ro[z][j][i],(<span class="keywordtype">int</span>)t1[z][j][i],(<span class="keywordtype">int</span>)t2[z][j][i],(<span class="keywordtype">int</span>)ki[z][j][i]);
00502  }
00503 
00504  <span class="comment">/* Reading the field default values in a file </span>
00505 <span class="comment"> * This file has been obtained with one of the </span>
00506 <span class="comment"> * suceptibility default computation method */</span>
00507  dech = (<a class="code" href="idvol-ido_8h.html#a37">PPPVOLUME_FLOAT</a>)<a class="code" href="idacr_8h.html#a72">IdAcrReadFile</a>(filedech,<a class="code" href="idvol-ido_8h.html#a6">VOL_FLOAT</a>);
00508  <span class="keywordflow">if</span> (!dech)
00509    {
00510     printf(<span class="stringliteral">"Unable to read the field default values %s \n"</span>,filedech);
00511     exit(1);
00512    }
00513  <a class="code" href="group__Object.html#ga2">SetObjectFieldDefault2D</a>(objet,z,dech,dimx,dimy);
00514 
00515  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ro);
00516  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t1);
00517  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(t2);
00518  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(ki);
00519  <a class="code" href="idvol_8h.html#a41">IdVolFree</a>(dech);
00520  <span class="keywordflow">return</span>(objet);
00521 }
00522 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 20 14:28:14 2006 for SIMRI3D by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
