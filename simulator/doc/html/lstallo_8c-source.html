<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SIMRI3D: lstallo.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>lstallo.c</h1><a href="lstallo_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*************************************************************************</span>
00002 <span class="comment">* $Id: lstallo.c,v 1.1 2005/09/09 08:22:51 bellet Exp $</span>
00003 <span class="comment">**************************************************************************</span>
00004 <span class="comment"> This software is governed by the CeCILL  license under French law and</span>
00005 <span class="comment">  abiding by the rules of distribution of free software.  You can  use, </span>
00006 <span class="comment">  modify and/ or redistribute the software under the terms of the CeCILL</span>
00007 <span class="comment">  license as circulated by CEA, CNRS and INRIA at the following URL</span>
00008 <span class="comment">  "http://www.cecill.info". </span>
00009 <span class="comment">  </span>
00010 <span class="comment">  As a counterpart to the access to the source code and  rights to copy,</span>
00011 <span class="comment">  modify and redistribute granted by the license, users are provided only</span>
00012 <span class="comment">  with a limited warranty  and the software's author,  the holder of the</span>
00013 <span class="comment">  economic rights,  and the successive licensors  have only  limited</span>
00014 <span class="comment">  liability. </span>
00015 <span class="comment">  </span>
00016 <span class="comment">  In this respect, the user's attention is drawn to the risks associated</span>
00017 <span class="comment">  with loading,  using,  modifying and/or developing or reproducing the</span>
00018 <span class="comment">  software by the user in light of its specific status of free software,</span>
00019 <span class="comment">  that may mean  that it is complicated to manipulate,  and  that  also</span>
00020 <span class="comment">  therefore means  that it is reserved for developers  and  experienced</span>
00021 <span class="comment">  professionals having in-depth computer knowledge. Users are therefore</span>
00022 <span class="comment">  encouraged to load and test the software's suitability as regards their</span>
00023 <span class="comment">  requirements in conditions enabling the security of their systems and/or </span>
00024 <span class="comment">  data to be ensured and,  more generally, to use and operate it in the </span>
00025 <span class="comment">  same conditions as regards security. </span>
00026 <span class="comment">  </span>
00027 <span class="comment">  The fact that you are presently reading this means that you have had</span>
00028 <span class="comment">  knowledge of the CeCILL license and that you accept its terms.</span>
00029 <span class="comment">  </span>
00030 <span class="comment">  Copyright (c) CREATIS (Centre de Recherche et d'Applications en Traitement de</span>
00031 <span class="comment">  l'Image). All rights reserved. See License.txt for details.</span>
00032 <span class="comment">  </span>
00033 <span class="comment">  Version 1.0  05/09/2005</span>
00034 <span class="comment">*************************************************************************/</span>
00035 
00036 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00037 <span class="preprocessor">#include "<a class="code" href="idliste_8h.html">idliste.h</a>"</span>
00038 <span class="preprocessor">#include "<a class="code" href="idprint_8h.html">idprint.h</a>"</span>
00039 <span class="comment">/*************************************************************************</span>
00040 <span class="comment">*</span>
00041 <span class="comment">*  Description : Allocation and destruction of LIST related objects</span>
00042 <span class="comment">*</span>
00043 <span class="comment">**************************************************************************/</span>
00044  
00053 <span class="keywordtype">void</span>
<a name="l00054"></a><a class="code" href="lstallo_8c.html#a0">00054</a> <a class="code" href="lstallo_8c.html#a0">_IdFreeElement</a>(<a class="code" href="struct__elem.html">PLIST_ELEMENT</a> p, <span class="keywordtype">int</span> d)
00055 {
00056    <span class="keywordflow">if</span> (p) {
00057       <a class="code" href="lstallo_8c.html#a0">_IdFreeElement</a>(p-&gt;<a class="code" href="struct__elem.html#o3">Next</a>, <a class="code" href="jerror_8h.html#a52a25">d</a>);
00058       <span class="keywordflow">if</span> (<a class="code" href="jerror_8h.html#a52a25">d</a>)
00059          <a class="code" href="lstallo_8c.html#a0">_IdFreeElement</a>(p-&gt;<a class="code" href="struct__elem.html#o4">Pred</a>, <a class="code" href="jerror_8h.html#a52a25">d</a>);
00060       free(p);
00061    }
00062 }
00063 
00069 <span class="keywordtype">void</span>
<a name="l00070"></a><a class="code" href="lstallo_8c.html#a1">00070</a> <a class="code" href="lstallo_8c.html#a1">_IdLstFree</a>(<a class="code" href="struct__elem.html">PLIST</a> * lst)
00071 {
00072    <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> p;
00073    <span class="keywordtype">int</span> m;
00074 
00075    <span class="keywordflow">if</span> (*lst) {
00076       <span class="keywordflow">if</span> (<a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_message)
00077          free((<a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_message));
00078       <a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_message = 0;
00079       if (<a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_fichier)
00080          free((<a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_fichier));
00081       <a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst)-&gt;_fichier = 0;
00082 
00083       if (<a class="code" href="idliste_8h.html#a12">IdLstNbElems</a>(*lst) != 0) {
00084          p = <a class="code" href="idliste_8h.html#a18">IdLstList</a>(*lst);
00085          m = 1;
00086          <span class="keywordflow">if</span> (p-&gt;<a class="code" href="struct__elem.html#o3">Next</a>)
00087             <span class="keywordflow">if</span> (p-&gt;<a class="code" href="struct__elem.html#o3">Next</a>-&gt;<a class="code" href="struct__elem.html#o4">Pred</a> == p)
00088                m = 0;
00089 
00090          <a class="code" href="lstallo_8c.html#a0">_IdFreeElement</a>(p, m);
00091       }
00092       free(<a class="code" href="idliste_8h.html#a8">_IdLstPrivate</a>(*lst));
00093       *lst = 0;
00094    }
00095 }
00096 
<a name="l00103"></a><a class="code" href="lstallo_8c.html#a2">00103</a> <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> <a class="code" href="idliste-restricted_8h.html#a4">_IdLstAllocElement</a>(<span class="keywordtype">void</span>)
00104 {
00105    <span class="keywordtype">void</span> *p = calloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__elem.html">LIST_ELEMENT</a>), 1);
00106 
00107    <span class="keywordflow">if</span> (!p)
00108       <a class="code" href="idprint_8h.html#a1">IdErrPrintf</a>
00109           (<span class="stringliteral">"Echec d'allocation d'element de liste. Memoire saturee."</span>);
00110    <span class="keywordflow">return</span> (<a class="code" href="struct__elem.html">PLIST_ELEMENT</a>) p;
00111 }
00112  
00120 <a class="code" href="struct__elem.html">PLIST</a>
<a name="l00121"></a><a class="code" href="lstallo_8c.html#a3">00121</a> <a class="code" href="idliste_8h.html#a37">IdLstAlloc</a>(<span class="keywordtype">void</span>)
00122 {
00123    <a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a> *si;
00124 
00125    si = (<a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a> *) calloc(<span class="keyword">sizeof</span>(<a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a>), 1);
00126    <span class="keywordflow">if</span> (si) {
00127       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o6">Type</a> = <a class="code" href="idgen_8h.html#a15">LST</a>;
00128       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o4">_message</a> = 0;
00129       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o5">_fichier</a> = 0;
00130    } <span class="keywordflow">else</span> {
00131       <a class="code" href="idprint_8h.html#a1">IdErrPrintf</a>
00132           (<span class="stringliteral">"Echec d'allocation 'partie privee' de liste."</span>);
00133    }
00134 
00135    <span class="keywordflow">return</span> ((<a class="code" href="struct__elem.html">PLIST</a>) &amp; (si[1]));
00136 }
00137 
00146 <a class="code" href="struct__elem.html">PLIST_ELEMENT</a>
<a name="l00147"></a><a class="code" href="lstallo_8c.html#a4">00147</a> <a class="code" href="lstallo_8c.html#a4">IdLstSearchElemObj</a>(<a class="code" href="struct__elem.html">PLIST</a> pl, <span class="keywordtype">void</span> *obj)
00148 {
00149    <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> el;
00150    el = <a class="code" href="idliste_8h.html#a17">IdLstFirst</a>(pl);
00151    <span class="keywordflow">while</span> (el) {
00152       <span class="keywordflow">if</span> (el-&gt;<a class="code" href="struct__elem.html#o2">Object</a> == obj) {
00153          <span class="keywordflow">return</span> ((<a class="code" href="struct__elem.html">PLIST_ELEMENT</a>) el);
00154       }
00155       el = el-&gt;<a class="code" href="struct__elem.html#o3">Next</a>;
00156    }
00157    <span class="keywordflow">return</span> (0);
00158 }
00159 
00182 <a class="code" href="struct__elem.html">PLIST_ELEMENT</a>
<a name="l00183"></a><a class="code" href="lstallo_8c.html#a5">00183</a> <a class="code" href="lstallo_8c.html#a5">IdLstFindElem</a>(<a class="code" href="struct__elem.html">PLIST</a> pl,
00184        <span class="keywordtype">int</span> (*UserCompareFonc) (<a class="code" href="struct__elem.html">PLIST_ELEMENT</a>, <span class="keywordtype">void</span> *),
00185        <span class="keywordtype">void</span> *key)
00186 {
00187    <a class="code" href="idliste_8h.html#a31">PLIST_ELEMENT</a> el;
00188    el = <a class="code" href="idliste_8h.html#a17">IdLstFirst</a>(pl);
00189    <span class="keywordflow">while</span> (el) {
00190       <span class="keywordflow">if</span> (UserCompareFonc(el, key) == 0)
00191          <span class="keywordflow">return</span> (el);
00192       el = el-&gt;<a class="code" href="struct__elem.html#o3">Next</a>;
00193    }
00194    <span class="keywordflow">return</span> (0);
00195 }
00196 
00206 <span class="keywordtype">void</span>
<a name="l00207"></a><a class="code" href="lstallo_8c.html#a6">00207</a> <a class="code" href="lstallo_8c.html#a6">_IdLstDestroyNoControl</a>(<a class="code" href="struct__elem.html">PLIST</a> * lst,
00208           VOID_FUNCTION_VOIDP_POINTER foncDestr)
00209 {
00210    <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> e;
00211    <span class="keywordflow">if</span> (!*lst)
00212       <span class="keywordflow">return</span>;
00213    e = <a class="code" href="idliste_8h.html#a17">IdLstFirst</a>(*lst);
00214    <span class="keywordflow">while</span> (e != NULL) {
00215       foncDestr(<a class="code" href="idliste_8h.html#a22">IdLstPtrObj</a>(e));
00216       e = <a class="code" href="idliste_8h.html#a20">IdLstNext</a>(e);
00217    }
00218    <a class="code" href="lstallo_8c.html#a1">_IdLstFree</a>(lst);
00219 }
00220 
00230 <span class="keywordtype">void</span>
<a name="l00231"></a><a class="code" href="lstallo_8c.html#a7">00231</a> <a class="code" href="lstallo_8c.html#a7">IdLstClear</a>(<a class="code" href="struct__elem.html">PLIST</a> lst)
00232 {
00233    <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> e, suiv;
00234    <span class="keywordflow">if</span> (!lst)
00235       <span class="keywordflow">return</span>;
00236    e = <a class="code" href="idliste_8h.html#a17">IdLstFirst</a>(lst);
00237    <span class="keywordflow">while</span> (e != NULL) {
00238       suiv = <a class="code" href="idliste_8h.html#a20">IdLstNext</a>(e);
00239       <a class="code" href="lstbasic_8c.html#a3">IdLstRemoveElem</a>(lst, e);
00240       e = suiv;
00241    }
00242 }
00243 
00255 <span class="keywordtype">void</span>
<a name="l00256"></a><a class="code" href="lstallo_8c.html#a8">00256</a> <a class="code" href="lstallo_8c.html#a8">IdLstDestroyElemNoControl</a>(<a class="code" href="struct__elem.html">PLIST</a> lst,
00257              <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> elem,
00258              VOID_FUNCTION_VOIDP_POINTER foncDestr)
00259 {
00260    <span class="keywordflow">if</span> (!lst)
00261       <span class="keywordflow">return</span>;
00262    <span class="keywordflow">if</span> (!elem)
00263       <span class="keywordflow">return</span>;
00264    foncDestr(<a class="code" href="idliste_8h.html#a22">IdLstPtrObj</a>(elem));
00265    <a class="code" href="lstbasic_8c.html#a3">IdLstRemoveElem</a>(lst, elem);
00266 }
00267 
00275 <a class="code" href="struct__elem.html">PLIST</a>
<a name="l00276"></a><a class="code" href="lstallo_8c.html#a9">00276</a> <a class="code" href="lstallo_8c.html#a9">IdLstCopy</a>(<a class="code" href="struct__elem.html">PLIST</a> lst)
00277 {
00278    <a class="code" href="struct__elem.html">PLIST_ELEMENT</a> ed;
00279    <a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a> *si;
00280    <a class="code" href="struct__elem.html">PLIST</a> lstResult;
00281    <span class="keywordtype">int</span> retCode;
00282 
00283    <span class="keywordflow">if</span> (!lst)
00284       <span class="keywordflow">return</span> ((<a class="code" href="struct__elem.html">PLIST</a>) NULL);
00285 
00286    si = (<a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a> *) calloc(<span class="keyword">sizeof</span>(<a class="code" href="structPRIVATE__LIST.html">PRIVATE_LIST</a>), 1);
00287    <span class="keywordflow">if</span> (si) {
00288       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o6">Type</a> = <a class="code" href="idgen_8h.html#a15">LST</a>;
00289       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o4">_message</a> = 0;
00290       si-&gt;<a class="code" href="structPRIVATE__LIST.html#o5">_fichier</a> = 0;
00291    } <span class="keywordflow">else</span> {
00292       <a class="code" href="idprint_8h.html#a1">IdErrPrintf</a>
00293           (<span class="stringliteral">"Echec allocation 'partie privee' de liste.\n"</span>);
00294       <span class="keywordflow">return</span> ((<a class="code" href="struct__elem.html">PLIST</a>) NULL);
00295    }
00296 
00297    lstResult = (<a class="code" href="struct__elem.html">PLIST</a>) &amp; (si[1]);
00298 
00299    ed = <a class="code" href="idliste_8h.html#a17">IdLstFirst</a>(lst);
00300 
00301    <span class="keywordflow">while</span> (ed != NULL) {
00302       retCode = <a class="code" href="idliste_8h.html#a24">IdLstAddLast</a>(lstResult, <a class="code" href="idliste_8h.html#a22">IdLstPtrObj</a>(ed));
00303       <span class="keywordflow">if</span> (!retCode) {
00304          <a class="code" href="idprint_8h.html#a1">IdErrPrintf</a>
00305              (<span class="stringliteral">"Echec allocation 'Element' de liste.\n"</span>);
00306          <span class="keywordflow">return</span> ((<a class="code" href="struct__elem.html">PLIST</a>) NULL);
00307       }
00308       ed = <a class="code" href="idliste_8h.html#a20">IdLstNext</a>(ed);
00309    }
00310 
00311    <span class="keywordflow">return</span> (lstResult);
00312 }
00313  
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 20 14:28:14 2006 for SIMRI3D by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
