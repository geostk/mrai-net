<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SIMRI3D: cntutil.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>cntutil.c</h1><a href="cntutil_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*************************************************************************</span>
00002 <span class="comment">* $Id: cntutil.c,v 1.1 2005/09/09 08:22:23 bellet Exp $</span>
00003 <span class="comment">**************************************************************************</span>
00004 <span class="comment"> This software is governed by the CeCILL  license under French law and</span>
00005 <span class="comment">  abiding by the rules of distribution of free software.  You can  use, </span>
00006 <span class="comment">  modify and/ or redistribute the software under the terms of the CeCILL</span>
00007 <span class="comment">  license as circulated by CEA, CNRS and INRIA at the following URL</span>
00008 <span class="comment">  "http://www.cecill.info". </span>
00009 <span class="comment">  </span>
00010 <span class="comment">  As a counterpart to the access to the source code and  rights to copy,</span>
00011 <span class="comment">  modify and redistribute granted by the license, users are provided only</span>
00012 <span class="comment">  with a limited warranty  and the software's author,  the holder of the</span>
00013 <span class="comment">  economic rights,  and the successive licensors  have only  limited</span>
00014 <span class="comment">  liability. </span>
00015 <span class="comment">  </span>
00016 <span class="comment">  In this respect, the user's attention is drawn to the risks associated</span>
00017 <span class="comment">  with loading,  using,  modifying and/or developing or reproducing the</span>
00018 <span class="comment">  software by the user in light of its specific status of free software,</span>
00019 <span class="comment">  that may mean  that it is complicated to manipulate,  and  that  also</span>
00020 <span class="comment">  therefore means  that it is reserved for developers  and  experienced</span>
00021 <span class="comment">  professionals having in-depth computer knowledge. Users are therefore</span>
00022 <span class="comment">  encouraged to load and test the software's suitability as regards their</span>
00023 <span class="comment">  requirements in conditions enabling the security of their systems and/or </span>
00024 <span class="comment">  data to be ensured and,  more generally, to use and operate it in the </span>
00025 <span class="comment">  same conditions as regards security. </span>
00026 <span class="comment">  </span>
00027 <span class="comment">  The fact that you are presently reading this means that you have had</span>
00028 <span class="comment">  knowledge of the CeCILL license and that you accept its terms.</span>
00029 <span class="comment">  </span>
00030 <span class="comment">  Copyright (c) CREATIS (Centre de Recherche et d'Applications en Traitement de</span>
00031 <span class="comment">  l'Image). All rights reserved. See License.txt for details.</span>
00032 <span class="comment">  </span>
00033 <span class="comment">  Version 1.0  05/09/2005</span>
00034 <span class="comment">*************************************************************************/</span>
00035 
00036 <span class="comment">/*************************************************************************</span>
00037 <span class="comment">*</span>
00038 <span class="comment">*  Description : Divers Utilitaires sur CONTOUR.</span>
00039 <span class="comment">*</span>
00040 <span class="comment">**************************************************************************/</span>
00041 <span class="preprocessor">#include &lt;math.h&gt;</span>
00042 <span class="preprocessor">#include &lt;string.h&gt;</span>  <span class="comment">// For memcpy() and memset()</span>
00043 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>  <span class="comment">// For abs()</span>
00044 <span class="preprocessor">#include "<a class="code" href="idcnt_8h.html">idcnt.h</a>"</span>
00045 <span class="preprocessor">#include "<a class="code" href="idcalc_8h.html">idcalc.h</a>"</span>
00046 <span class="preprocessor">#include "<a class="code" href="iderr_8h.html">iderr.h</a>"</span>
00047 <span class="preprocessor">#include "<a class="code" href="idprint_8h.html">idprint.h</a>"</span>
00048 
00049 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00050 <span class="comment"></span>
00051 <span class="comment">IdCntAddPoint (macro)</span>
00052 <span class="comment">  </span>
00053 <span class="comment">RESUME: Ajoute un point a un contour USHORT</span>
00054 <span class="comment"></span>
00055 <span class="comment">DESCRIPTION:   ajoute un point a un contour USHORT. UsedNbX est mis a jour. </span>
00056 <span class="comment">      Le contour est re-alloue a une longueur effective plus grande si besoin est. </span>
00057 <span class="comment">      -- ATTENTION -- </span>
00058 <span class="comment">      Si le CNT est associe a un Graph (LibIDO Graphique)</span>
00059 <span class="comment">      NE PAS UTILISER cette fonction</span>
00060 <span class="comment">      (le Graph ne sera pas informe du 'changement d'adresse'</span>
00061 <span class="comment">       de son CNT en cas de realloc ... )</span>
00062 <span class="comment">      Utiliser ds ce cas la fonction LibIDO Graphique IwGraphAddPoint</span>
00063 <span class="comment">      qui prend en compte ce genre de pb...</span>
00064 <span class="comment"></span>
00065 <span class="comment"></span>
00066 <span class="comment">SYNTAXE:     int retCode = IdCntAddPoint(PCONTOUR_USHORT cnt, int x, int y);</span>
00067 <span class="comment"></span>
00068 <span class="comment">RETOUR:      type  : int</span>
00069 <span class="comment">        role  : </span>
00070 <span class="comment"></span>
00071 <span class="comment">PARAMETRES:</span>
00072 <span class="comment">        nom   : cnt</span>
00073 <span class="comment">        type  : PCONTOUR_USHORT</span>
00074 <span class="comment">        role  : contour d'origine.</span>
00075 <span class="comment"></span>
00076 <span class="comment">        nom   : x,y</span>
00077 <span class="comment">        type  : int</span>
00078 <span class="comment">        role  : coordonnes X et Y du point a rajouter</span>
00079 <span class="comment"></span>
00080 <span class="comment">FICHIER:   idcnt.h </span>
00081 <span class="comment"></span>
00082 <span class="comment">EXEMPLE:  </span>
00083 <span class="comment">   </span>
00084 <span class="comment">******************************************************** END DESCRIPTION */</span>
00085 
<a name="l00086"></a><a class="code" href="idcnt-restricted_8h.html#a2">00086</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-restricted_8h.html#a2">_IdCntAddPoint</a>(contour,valx,valy) 
00087 <a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a> *contour;
00088 <span class="keywordtype">int</span> valx,valy;
00089 {
00090 <span class="keywordflow">if</span>( <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour) == <a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(*contour) ) 
00091       *contour=(<a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a>)<a class="code" href="idcnt-calc_8h.html#a25">IdCntModifLongueur</a>(*contour, (<a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(*contour)*3)/2 +1); <span class="comment">/* +1 .... A. ANWANDER */</span>
00092  
00093 <span class="keywordflow">if</span> (*contour==NULL) <span class="keywordflow">return</span> 0;
00094 
00095 <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(*contour,<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour),valx);
00096 <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(*contour,<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour),valy);
00097 
00098 <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour)++; 
00099 
00100 <span class="keywordflow">return</span>(1);
00101 }
00102 
00103 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00104 <span class="comment"></span>
00105 <span class="comment">IdCntInsertPoint (macro)   </span>
00106 <span class="comment">  </span>
00107 <span class="comment">RESUME: Insere un point ds un contour USHORT</span>
00108 <span class="comment"></span>
00109 <span class="comment">DESCRIPTION:   Insere 1 point ds 1 contour USHORT APRES un point de numero donne.</span>
00110 <span class="comment">      -1 signifie que l'on ajoute en tete</span>
00111 <span class="comment">      UsedNbX est mis a jour. </span>
00112 <span class="comment">      Le contour est re-alloue a une longueur effective plus grande si besoin est. </span>
00113 <span class="comment">      -- ATTENTION -- </span>
00114 <span class="comment">      Si le CNT est associe a un Graph (LibIDO Graphique)</span>
00115 <span class="comment">      NE PAS UTILISER cette fonction</span>
00116 <span class="comment">      (le Graph ne sera pas informe du 'changement d'adresse'</span>
00117 <span class="comment">       de son CNT en cas de realloc ... )</span>
00118 <span class="comment">      Utiliser ds ce cas la fonction LibIDO Graphique IwGraphAddPoint</span>
00119 <span class="comment">      qui prend en compte ce genre de pb...</span>
00120 <span class="comment"></span>
00121 <span class="comment">SYNTAXE:    int retCode = IdCntInsertPoint(PCONTOUR_USHORT cnt, int numPoint, int x, int y);</span>
00122 <span class="comment"></span>
00123 <span class="comment">RETOUR:      type  : int</span>
00124 <span class="comment">        role  : code de retour booleen.</span>
00125 <span class="comment"></span>
00126 <span class="comment">PARAMETRES:</span>
00127 <span class="comment">        nom   : cnt</span>
00128 <span class="comment">        type  : PCONTOUR_USHORT</span>
00129 <span class="comment">        role  : contour d'origine.</span>
00130 <span class="comment"></span>
00131 <span class="comment">        nom   : numPoint</span>
00132 <span class="comment">        type  : int</span>
00133 <span class="comment">        role  : numero du point APRES lequel on veut rajouter</span>
00134 <span class="comment"></span>
00135 <span class="comment">        nom   : x,y</span>
00136 <span class="comment">        type  : int</span>
00137 <span class="comment">        role  : coordonnes X et Y du point a rajouter</span>
00138 <span class="comment"></span>
00139 <span class="comment">FICHIER:   idcnt.h </span>
00140 <span class="comment"></span>
00141 <span class="comment">EXEMPLE:  </span>
00142 <span class="comment">   </span>
00143 <span class="comment">******************************************************** END DESCRIPTION */</span>
00144 
<a name="l00145"></a><a class="code" href="idcnt-restricted_8h.html#a1">00145</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-restricted_8h.html#a1">_IdCntInsertPoint</a>(contour,numPoint,valx,valy) 
00146 <a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a> *contour;
00147 <span class="keywordtype">int</span> valx,valy,numPoint;
00148 {
00149 <span class="keywordtype">int</span> i;
00150   <span class="keywordflow">if</span> ( !*contour ) {                                  
00151     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00152     <span class="keywordflow">return</span> 0;
00153   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(*contour) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00154     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00155     <span class="keywordflow">return</span> 0;
00156    }
00157 
00158 <span class="comment">/*IdPrintf ("numero du point apres lequel inserer :%d\n",numPoint);*/</span>
00159 
00160 <span class="keywordflow">if</span> (numPoint == <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour))
00161    {  
00162 
00163 <span class="comment">/*IdPrintf("numPoint= dernier point\n");*/</span>
00164    i = <a class="code" href="idcnt-base_8h.html#a2">IdCntAddPoint</a>(*contour,valx,valy);
00165    <span class="keywordflow">if</span> (i==0) { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Insertion Point\n"</span>);
00166           <span class="keywordflow">return</span>(0);
00167         }
00168    <span class="keywordflow">return</span>(1);
00169    }        
00170 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( numPoint &lt;-1)  {    <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a9">IDERR_INVALID_NUMBER</a>;
00171             <span class="keywordflow">return</span> 0;
00172             }
00173 <span class="keywordflow">else</span> 
00174 {  <span class="keywordflow">if</span> ( <a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(*contour) == <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour))
00175    { 
00176       <span class="comment">/* Rallonger le Contour */</span>
00177 
00178     *contour =(<a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a>) <a class="code" href="idcnt-calc_8h.html#a25">IdCntModifLongueur</a>( *contour,(<a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(*contour)*3)/2+1);
00179 
00180 
00181    }     
00182    <span class="keywordflow">for</span> (i=<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(*contour)-1 ; i&gt;numPoint ; i--)
00183 
00184    { 
00185      <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(*contour,i+1,<a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(*contour,i));
00186      <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(*contour,i+1,<a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(*contour,i));
00187    }
00188 
00189    <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(*contour,numPoint+1,valx);
00190    <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(*contour,numPoint+1,valy);
00191 
00192    <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(*contour,<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(*contour)+1);
00193 }
00194 <span class="keywordflow">return</span>(1);
00195 }
00196 
00197 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00198 <span class="comment"></span>
00199 <span class="comment">IdCntMoveContour (fonction)      </span>
00200 <span class="comment">  </span>
00201 <span class="comment">RESUME: Deplace un contour USHORT ( +DeltaX, +DeltaY sur chaque point)</span>
00202 <span class="comment"></span>
00203 <span class="comment">DESCRIPTION:Deplace un contour USHORT ( +DeltaX, +DeltaY sur chaque point) </span>
00204 <span class="comment"></span>
00205 <span class="comment">SYNTAXE:     int retCode = IdCntMoveContour(PCONTOUR_USHORT cnt, int DeltaX, int DeltaY);</span>
00206 <span class="comment"></span>
00207 <span class="comment">RETOUR:      type  : int</span>
00208 <span class="comment">        role  : code de retour booleen.</span>
00209 <span class="comment"></span>
00210 <span class="comment">PARAMETRES:</span>
00211 <span class="comment">        nom   : cnt</span>
00212 <span class="comment">        type  : PCONTOUR_USHORT</span>
00213 <span class="comment">        role  : contour d'origine.</span>
00214 <span class="comment"></span>
00215 <span class="comment">        nom   : DeltaX,DeltaY</span>
00216 <span class="comment">        type  : int</span>
00217 <span class="comment">        role  : deplacement, en X et Y, des points</span>
00218 <span class="comment"></span>
00219 <span class="comment">FICHIER:   idcnt.h </span>
00220 <span class="comment"></span>
00221 <span class="comment">EXEMPLE:  </span>
00222 <span class="comment">   </span>
00223 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00224"></a><a class="code" href="idcnt-calc_8h.html#a27">00224</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a27">IdCntMoveContour</a>(contour,deltaX, deltaY) 
00225 <a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a> contour;
00226 <span class="keywordtype">int</span> deltaX, deltaY;
00227 {
00228  <span class="keywordtype">int</span> i;
00229   <span class="keywordflow">if</span> ( !contour ) {                                  
00230     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00231     <span class="keywordflow">return</span> 0;
00232     }
00233 
00234   <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour);i++)
00235    { 
00236    <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(contour,i,<a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i)+deltaX);
00237    <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(contour,i,<a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i)+deltaY);
00238    }
00239 <span class="keywordflow">return</span> 1;
00240 }
00241 
00242 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00243 <span class="comment"></span>
00244 <span class="comment">IdCntRotateContour (fonction) </span>
00245 <span class="comment">  </span>
00246 <span class="comment">RESUME: Fait tourner d'un angle donne un CNT USHORT autour d'un centre </span>
00247 <span class="comment"></span>
00248 <span class="comment">DESCRIPTION: Fait tourner d'un angle donne un CNT USHORT autour d'un centre </span>
00249 <span class="comment"></span>
00250 <span class="comment">SYNTAXE:     int retCode = IdCntRotateContour(PCONTOUR_USHORT cnt, int centreX, int centreY, double angle);</span>
00251 <span class="comment"></span>
00252 <span class="comment">RETOUR:      type  : int</span>
00253 <span class="comment">        role  : code de retour booleen.</span>
00254 <span class="comment"></span>
00255 <span class="comment">PARAMETRES:</span>
00256 <span class="comment">        nom   : cnt</span>
00257 <span class="comment">        type  : PCONTOUR_USHORT</span>
00258 <span class="comment">        role  : contour d'origine.</span>
00259 <span class="comment"></span>
00260 <span class="comment">        nom   : centreX,centreY</span>
00261 <span class="comment">        type  : int</span>
00262 <span class="comment">        role  : coordonnees du centre de rotation</span>
00263 <span class="comment"></span>
00264 <span class="comment">        nom   : angle</span>
00265 <span class="comment">        type  : double</span>
00266 <span class="comment">        role  : angle de rotation</span>
00267 <span class="comment"></span>
00268 <span class="comment">FICHIER:   cntutil.c</span>
00269 <span class="comment"></span>
00270 <span class="comment">EXEMPLE:  </span>
00271 <span class="comment">   </span>
00272 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00273"></a><a class="code" href="idcnt-calc_8h.html#a39">00273</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a39">IdCntRotateContour</a>(contour, centreX, centreY, angle) 
00274 <a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a> contour;
00275 <span class="keywordtype">int</span> centreX, centreY;
00276 <span class="keywordtype">double</span> angle;
00277 {
00278 <span class="keywordtype">double</span> <a class="code" href="jerror_8h.html#a52a35">x</a>,y;
00279 <span class="keywordtype">double</span> sinAlph, cosAlph;
00280 <span class="keywordtype">double</span> nouvX,nouvY;
00281 
00282  <span class="keywordtype">int</span> i;
00283   <span class="keywordflow">if</span> ( !contour ) {                                  
00284     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00285     <span class="keywordflow">return</span> 0;
00286     }
00287 sinAlph=sin(angle);
00288 cosAlph=cos(angle);
00289 
00290   <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour);i++)
00291    {
00292    <a class="code" href="jerror_8h.html#a52a35">x</a>= (<span class="keywordtype">double</span>)<a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i);
00293    y= (<span class="keywordtype">double</span>)<a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i);
00294 
00295    nouvX= cosAlph*(<a class="code" href="jerror_8h.html#a52a35">x</a>-(<span class="keywordtype">double</span>)centreX) -sinAlph*(y-(<span class="keywordtype">double</span>)centreY) + centreX;
00296    nouvY= sinAlph*(<a class="code" href="jerror_8h.html#a52a35">x</a>-(<span class="keywordtype">double</span>)centreX) +cosAlph*(y-(<span class="keywordtype">double</span>)centreY) + centreY;
00297 
00298    <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(contour,i,(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)nouvX);
00299    <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(contour,i,(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)nouvY);
00300 
00301    <a class="code" href="jerror_8h.html#a52a35">x</a>= (<span class="keywordtype">double</span>)<a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i);
00302    y= (<span class="keywordtype">double</span>)<a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i);
00303    }
00304 <span class="keywordflow">return</span> 1;
00305 }
00306 
00307 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00308 <span class="comment"></span>
00309 <span class="comment">IdCntRotateContourDouble (fonction) </span>
00310 <span class="comment">  </span>
00311 <span class="comment">RESUME: Fait tourner d'un angle donne un CNT DOUBLE autour d'un centre </span>
00312 <span class="comment"></span>
00313 <span class="comment">DESCRIPTION: Fait tourner d'un angle donne un CNT DOUBLE autour d'un centre </span>
00314 <span class="comment"></span>
00315 <span class="comment">SYNTAXE:     int retCode = IdCntRotateContourDouble(PCONTOUR_DOUBLE cnt, int centreX, int centreY, double angle);</span>
00316 <span class="comment"></span>
00317 <span class="comment">RETOUR:      type  : int</span>
00318 <span class="comment">        role  : code de retour booleen.</span>
00319 <span class="comment"></span>
00320 <span class="comment">PARAMETRES:</span>
00321 <span class="comment">        nom   : cnt</span>
00322 <span class="comment">        type  : PCONTOUR_DOUBLE</span>
00323 <span class="comment">        role  : contour d'origine.</span>
00324 <span class="comment"></span>
00325 <span class="comment">        nom   : centreX,centreY</span>
00326 <span class="comment">        type  : int</span>
00327 <span class="comment">        role  : coordonnees du centre de rotation</span>
00328 <span class="comment"></span>
00329 <span class="comment">        nom   : angle</span>
00330 <span class="comment">        type  : double</span>
00331 <span class="comment">        role  : angle de rotation</span>
00332 <span class="comment"></span>
00333 <span class="comment">FICHIER:   cntutil.c</span>
00334 <span class="comment"></span>
00335 <span class="comment">EXEMPLE:  </span>
00336 <span class="comment">   </span>
00337 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00338"></a><a class="code" href="idcnt-calc_8h.html#a40">00338</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a40">IdCntRotateContourDouble</a>(contour, centreX, centreY, angle) 
00339 <a class="code" href="structIDXPOINT__DOUBLE.html">PCONTOUR_DOUBLE</a> contour;
00340 <span class="keywordtype">int</span> centreX, centreY;
00341 <span class="keywordtype">double</span> angle;
00342 {
00343 <span class="keywordtype">double</span> <a class="code" href="jerror_8h.html#a52a35">x</a>,y;
00344 <span class="keywordtype">double</span> sinAlph, cosAlph;
00345 <span class="keywordtype">double</span> nouvX,nouvY;
00346 
00347  <span class="keywordtype">int</span> i;
00348   <span class="keywordflow">if</span> ( !contour ) {                                  
00349     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00350     <span class="keywordflow">return</span> 0;
00351     }
00352 sinAlph=sin(angle);
00353 cosAlph=cos(angle);
00354 
00355 <span class="comment">/*IdPrintf ("alpha %g sinApha %g cosAlpha %g\n",angle, sinAlph, cosAlph);*/</span>
00356 
00357   <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour);i++)
00358    {
00359    <a class="code" href="jerror_8h.html#a52a35">x</a>= <a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i);
00360    y= <a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i);
00361 
00362    nouvX= cosAlph*(<a class="code" href="jerror_8h.html#a52a35">x</a>-(<span class="keywordtype">double</span>)centreX) - sinAlph*(y-(<span class="keywordtype">double</span>)centreY) + centreX;
00363    nouvY= sinAlph*(<a class="code" href="jerror_8h.html#a52a35">x</a>-(<span class="keywordtype">double</span>)centreX) + cosAlph*(y-(<span class="keywordtype">double</span>)centreY) + centreY;
00364 
00365    <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(contour,i,nouvX);
00366    <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(contour,i,nouvY);
00367 
00368    <a class="code" href="jerror_8h.html#a52a35">x</a>= <a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i);
00369    y= <a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i);
00370    }
00371 <span class="keywordflow">return</span> 1;
00372 }
00373 
00374 
00375 
00376 
00377 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00378 <span class="comment"></span>
00379 <span class="comment">IdCntZoomContourDouble (fonction)   </span>
00380 <span class="comment">  </span>
00381 <span class="comment">RESUME: Zoome d'un %ge donne un CNT DOUBLE autour du centre du Rect Englob</span>
00382 <span class="comment"></span>
00383 <span class="comment">DESCRIPTION: Zoome d'un %ge donne un CNT DOUBLE autour du centre du Rect Englob</span>
00384 <span class="comment">      Si on connait les coord de centre du Rect Englob,</span>
00385 <span class="comment">      on les passe en param ,</span>
00386 <span class="comment">      sinon on passe -1., -1. et la fct les calcule</span>
00387 <span class="comment"></span>
00388 <span class="comment">SYNTAXE:     int retCode = IdCntZoomContourDouble(PCONTOUR_DOUBLE cnt, int centreX, int centreY, double percent);</span>
00389 <span class="comment"></span>
00390 <span class="comment">RETOUR:      type  : int</span>
00391 <span class="comment">        role  : code de retour booleen.</span>
00392 <span class="comment"></span>
00393 <span class="comment">PARAMETRES:</span>
00394 <span class="comment">        nom   : cnt</span>
00395 <span class="comment">        type  : PCONTOUR_DOUBLE</span>
00396 <span class="comment">        role  : contour d'origine.</span>
00397 <span class="comment"></span>
00398 <span class="comment">        nom   : centreX,centreY</span>
00399 <span class="comment">        type  : int</span>
00400 <span class="comment">        role  : coordonnees du centre du Rect Englob</span>
00401 <span class="comment">         -1.,-1. si on ne les connait pas</span>
00402 <span class="comment"></span>
00403 <span class="comment">        nom   : percent</span>
00404 <span class="comment">        type  : double</span>
00405 <span class="comment">        role  : pourcentage de zoom</span>
00406 <span class="comment"></span>
00407 <span class="comment">FICHIER:   cntutil.c</span>
00408 <span class="comment"></span>
00409 <span class="comment">EXEMPLE:  </span>
00410 <span class="comment">   </span>
00411 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00412"></a><a class="code" href="idcnt-calc_8h.html#a41">00412</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a41">IdCntZoomContourDouble</a>(contour, centreX, centreY, percent) 
00413 <a class="code" href="structIDXPOINT__DOUBLE.html">PCONTOUR_DOUBLE</a> contour;
00414 <span class="keywordtype">int</span> centreX, centreY;
00415 <span class="keywordtype">double</span> percent;
00416 {
00417 <span class="keywordtype">double</span> <a class="code" href="jerror_8h.html#a52a35">x</a>,y;
00418 <span class="keywordtype">double</span> angle, oldDist, newDist;
00419 <span class="keywordtype">double</span> nouvX,nouvY;
00420 
00421  <span class="keywordtype">int</span> i;
00422   <span class="keywordflow">if</span> ( !contour ) {                                  
00423     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00424     <span class="keywordflow">return</span> 0;
00425     }
00426 
00427 percent= 1.+ (percent/100.);
00428 
00429 <span class="keywordflow">if</span> ( (centreX == -1.) &amp;&amp; (centreX == -1.) ) <span class="comment">/* a tester ... JPR */</span>
00430    {
00431    <span class="keywordtype">int</span> x0,y0, x1,y1;
00432    <a class="code" href="idcnt-calc_8h.html#a26">IdCntRectEnglob</a>((<a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a>)contour, &amp;x0, &amp;y0, &amp;x1, &amp;y1 );
00433    centreX = abs( x1-x0) /2;
00434    centreY = abs( y1-y0) /2;
00435    }
00436 
00437   <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour);i++)
00438    {
00439 
00440    <a class="code" href="jerror_8h.html#a52a35">x</a>= <a class="code" href="idcnt-ido_8h.html#a13">IdCntGetX</a>(contour,i);
00441    y= <a class="code" href="idcnt-ido_8h.html#a14">IdCntGetY</a>(contour,i);
00442 
00443    angle= atan2 ((<span class="keywordtype">double</span>)(y - centreY), (<span class="keywordtype">double</span>)(<a class="code" href="jerror_8h.html#a52a35">x</a> - centreX)); 
00444 
00445    oldDist=<a class="code" href="utilcalc_8c.html#a14">IdCalcDistance2Points</a>((<span class="keywordtype">double</span>)centreX,  (<span class="keywordtype">double</span>)centreY,
00446                   (<span class="keywordtype">double</span>)<a class="code" href="jerror_8h.html#a52a35">x</a>,  (<span class="keywordtype">double</span>)y   );
00447    newDist=oldDist*percent;
00448 
00449    nouvX= centreX + newDist*cos(angle);
00450    nouvY= centreY + newDist*sin(angle);
00451 
00452    <a class="code" href="idcnt-ido_8h.html#a11">IdCntSetX</a>(contour,i,nouvX);
00453    <a class="code" href="idcnt-ido_8h.html#a12">IdCntSetY</a>(contour,i,nouvY);
00454 
00455    }
00456 <span class="keywordflow">return</span> 1;
00457 }
00458 
00459 
00460 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00461 <span class="comment"></span>
00462 <span class="comment">IdCntDelPoint (fonction)</span>
00463 <span class="comment">  </span>
00464 <span class="comment">RESUME: Supprime un point a un contour </span>
00465 <span class="comment"></span>
00466 <span class="comment">DESCRIPTION:   Supprime un point a un contour. UsedNbX est mis a jour. </span>
00467 <span class="comment"></span>
00468 <span class="comment">SYNTAXE:     int retCode = IdCntDelPoint(PCONTOUR cnt, int numPoint);</span>
00469 <span class="comment"></span>
00470 <span class="comment">RETOUR:      type  : int</span>
00471 <span class="comment">        role  : code de retour booleen.</span>
00472 <span class="comment"></span>
00473 <span class="comment">PARAMETRES:</span>
00474 <span class="comment">        nom   : cnt</span>
00475 <span class="comment">        type  : PCONTOUR</span>
00476 <span class="comment">        role  : contour d'origine.</span>
00477 <span class="comment"></span>
00478 <span class="comment">        nom   : numPoint</span>
00479 <span class="comment">        type  : int</span>
00480 <span class="comment">        role  : numero du point a supprimer</span>
00481 <span class="comment"></span>
00482 <span class="comment">FICHIER:   cntutil.c </span>
00483 <span class="comment"></span>
00484 <span class="comment">EXEMPLE:  </span>
00485 <span class="comment">   </span>
00486 <span class="comment">******************************************************** END DESCRIPTION */</span>
00487 
<a name="l00488"></a><a class="code" href="idcnt-calc_8h.html#a22">00488</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a22">IdCntDelPoint</a>(contour,numPoint) 
00489 PCONTOUR contour;
00490 <span class="keywordtype">int</span> numPoint;
00491 {
00492 <span class="keywordtype">char</span> * debut;
00493  
00494   <span class="keywordflow">if</span> ( !contour ) {                                  
00495     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00496     <span class="keywordflow">return</span> 0;
00497   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(contour) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00498     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00499     <span class="keywordflow">return</span> 0;
00500    }
00501 
00502 <span class="keywordflow">if</span>( (numPoint &gt; <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour) ) || ( numPoint &lt;0) ) { <span class="keywordflow">return</span> 0; }
00503  
00504 debut = (<span class="keywordtype">char</span>*) contour + numPoint * <a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour);
00505 
00506 memcpy   (  debut,
00507       debut+<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour),
00508       (<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(contour)-numPoint-1)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour)
00509    );
00510 
00511 <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(contour,<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(contour)-1);
00512 
00513 <span class="keywordflow">return</span>(1);
00514 }
00515 
00516 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00517 <span class="comment"></span>
00518 <span class="comment">IdCntDelPoints (fonction)</span>
00519 <span class="comment">  </span>
00520 <span class="comment">RESUME: Supprime un ensemble de points a un contour </span>
00521 <span class="comment"></span>
00522 <span class="comment">DESCRIPTION:   Supprime un ensemble de points a un contour. UsedNbX est mis a jour. </span>
00523 <span class="comment"></span>
00524 <span class="comment">SYNTAXE:     int retCode = IdCntDelPoints(PCONTOUR cnt, int numPoint1, int numPoint2);</span>
00525 <span class="comment"></span>
00526 <span class="comment">RETOUR:      type  : int</span>
00527 <span class="comment">        role  : code de retour booleen.</span>
00528 <span class="comment"></span>
00529 <span class="comment">PARAMETRES:</span>
00530 <span class="comment">        nom   : cnt</span>
00531 <span class="comment">        type  : PCONTOUR</span>
00532 <span class="comment">        role  : contour d'origine.</span>
00533 <span class="comment"></span>
00534 <span class="comment">        nom   : numPoint1</span>
00535 <span class="comment">        type  : int</span>
00536 <span class="comment">        role  : numero du premier point a supprimer</span>
00537 <span class="comment"></span>
00538 <span class="comment">        nom   : numPoint2</span>
00539 <span class="comment">        type  : int</span>
00540 <span class="comment">        role  : numero du dernier point a supprimer</span>
00541 <span class="comment"></span>
00542 <span class="comment">FICHIER:   cntutil.c </span>
00543 <span class="comment"></span>
00544 <span class="comment">EXEMPLE:  </span>
00545 <span class="comment">   </span>
00546 <span class="comment">******************************************************** END DESCRIPTION */</span>
00547 
<a name="l00548"></a><a class="code" href="idcnt-calc_8h.html#a23">00548</a> <span class="keywordtype">int</span> <a class="code" href="idcnt-calc_8h.html#a23">IdCntDelPoints</a>(contour,numPoint1,numPoint2) 
00549 PCONTOUR contour;
00550 <span class="keywordtype">int</span> numPoint1,numPoint2;
00551 {
00552 <span class="keywordtype">char</span> * debut;
00553 <span class="keywordtype">int</span> nbpSupr;
00554  
00555   <span class="keywordflow">if</span> ( !contour ) {                                  
00556     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00557     <span class="keywordflow">return</span> 0;
00558   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(contour) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00559     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00560     <span class="keywordflow">return</span> 0;
00561    }
00562 <span class="keywordflow">if</span>(numPoint1&gt;numPoint2) { <span class="keywordflow">return</span> 0; }
00563 
00564 <span class="keywordflow">if</span>( (numPoint1 &gt; <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour)-1 ) || ( numPoint1 &lt;0) ) { <span class="keywordflow">return</span> 0; }
00565 <span class="keywordflow">if</span>( (numPoint2 &gt; <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour)-1 ) || ( numPoint2 &lt;0) ) { <span class="keywordflow">return</span> 0; }
00566 
00567 nbpSupr= numPoint2-numPoint1+1;
00568 
00569 debut = (<span class="keywordtype">char</span>*) contour + numPoint1 * <a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour);
00570 
00571 memcpy   (  debut,
00572       debut+<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour)*nbpSupr, 
00573       (<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(contour)-numPoint2-1)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour)
00574    );
00575 
00576 <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(contour,<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(contour)-nbpSupr);
00577 
00578 <span class="keywordflow">return</span>(1);
00579 }
00580 
00581 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00582 <span class="comment"></span>
00583 <span class="comment">IdCntConcat (fonction)     </span>
00584 <span class="comment">  </span>
00585 <span class="comment">RESUME: Concatene 2 objets CNT. UsedNbX est mis a jour </span>
00586 <span class="comment"></span>
00587 <span class="comment">DESCRIPTION:   Concatene 2 objets CNT. UsedNbX est mis a jour. </span>
00588 <span class="comment"></span>
00589 <span class="comment">SYNTAXE:     PCONTOUR CntResult = IdCntConcat(PCONTOUR cnt1, PCONTOUR cnt2);</span>
00590 <span class="comment"></span>
00591 <span class="comment">RETOUR:      type  : PCONTOUR</span>
00592 <span class="comment">        role  : contour concatene.</span>
00593 <span class="comment"></span>
00594 <span class="comment">PARAMETRES:</span>
00595 <span class="comment">        nom   : cnt1</span>
00596 <span class="comment">        type  : PCONTOUR</span>
00597 <span class="comment">        role  : contour d'origine.</span>
00598 <span class="comment"></span>
00599 <span class="comment">        nom   : cnt2</span>
00600 <span class="comment">        type  : PCONTOUR</span>
00601 <span class="comment">        role  : contour a rajouter</span>
00602 <span class="comment"></span>
00603 <span class="comment">FICHIER:   idcnt.h </span>
00604 <span class="comment"></span>
00605 <span class="comment">EXEMPLE:  </span>
00606 <span class="comment">   </span>
00607 <span class="comment">******************************************************** END DESCRIPTION */</span>
00608 
<a name="l00609"></a><a class="code" href="idcnt-calc_8h.html#a42">00609</a> <a class="code" href="idcnt-ido_8h.html#a25">PCONTOUR</a> <a class="code" href="idcnt-calc_8h.html#a42">IdCntConcat</a>(contour1,contour2) 
00610 PCONTOUR contour1,contour2;
00611 {
00612 <span class="keywordtype">char</span> * fin;
00613 <span class="keywordtype">int</span> nouvlong; 
00614   <span class="keywordflow">if</span> ( !contour1 ) {                                  
00615     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00616     <span class="keywordflow">return</span> 0;
00617   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(contour1) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00618     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00619     <span class="keywordflow">return</span> 0;
00620    }
00621  
00622   <span class="keywordflow">if</span> ( !contour2 ) {                                  
00623     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00624     <span class="keywordflow">return</span> 0;
00625   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(contour2) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00626     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00627     <span class="keywordflow">return</span> 0;
00628    }
00629 <span class="keywordflow">if</span> (!<a class="code" href="idcnt-base_8h.html#a0">IdCntSameType</a>(contour1,contour2)){
00630     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00631     <span class="keywordflow">return</span> 0;
00632    }
00633 
00634 nouvlong= <a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour1)+<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour2);
00635 <span class="keywordflow">if</span> (<a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(contour1) &lt; nouvlong)
00636       contour1 = <a class="code" href="idcnt-calc_8h.html#a25">IdCntModifLongueur</a> (contour1,(nouvlong*3)/2);
00637  
00638 fin = (<span class="keywordtype">char</span>*) contour1 + (<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour1))*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour1);
00639 
00640 memcpy (fin,contour2,<a class="code" href="idcnt-ido_8h.html#a19">IdCntUsedNbX</a>(contour2)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(contour2));
00641  
00642 <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(contour1,nouvlong);
00643 
00644 <span class="keywordflow">return</span>(contour1);
00645 }
00646 
00647 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00648 <span class="comment"></span>
00649 <span class="comment">IdCntClear (fonction)</span>
00650 <span class="comment"></span>
00651 <span class="comment">RESUME: initialisation d'un Contour a 0</span>
00652 <span class="comment"></span>
00653 <span class="comment">DESCRIPTION: Initialisation d'un Contour a 0</span>
00654 <span class="comment"></span>
00655 <span class="comment">SYNTAXE:     PCONTOUR CntResult = IdCntClear (PCONTOUR contResult);</span>
00656 <span class="comment"></span>
00657 <span class="comment">RETOUR:      type  : PCONTOUR</span>
00658 <span class="comment">        role  : Pointeur vers le contour initialise. Zero si echec.</span>
00659 <span class="comment"></span>
00660 <span class="comment">PARAMETRES:  nom   : contResult</span>
00661 <span class="comment">        type  : PCONTOUR</span>
00662 <span class="comment">        role  : Pointeur vers le contour a initialiser.</span>
00663 <span class="comment"></span>
00664 <span class="comment">FICHIER:     cntutil.c</span>
00665 <span class="comment"></span>
00666 <span class="comment">EXEMPLE:     if ( IdCntClear(contour)==0 )</span>
00667 <span class="comment">          IdErrPrintf("ERREUR: %s",IdErrMsg(IdErrno));</span>
00668 <span class="comment"></span>
00669 <span class="comment">******************************************************** END DESCRIPTION */</span>
00670 
<a name="l00671"></a><a class="code" href="idcnt-base_8h.html#a5">00671</a> <a class="code" href="idcnt-ido_8h.html#a25">PCONTOUR</a> <a class="code" href="idcnt-base_8h.html#a5">IdCntClear</a> ( cont )
00672 PCONTOUR cont;
00673 {
00674 <span class="comment">/*  int y;*/</span>
00675   <span class="keywordtype">int</span> taille_cont;
00676                    <span class="comment">/* Controle du contour **/</span>
00677   <span class="keywordflow">if</span> ( !cont ) {                                  
00678     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a5">IDERR_POINTER_IS_NULL</a>;
00679     <span class="keywordflow">return</span> 0;
00680   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(cont) != <a class="code" href="idgen_8h.html#a16">CNT</a>) {
00681     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00682     <span class="keywordflow">return</span> 0;
00683   }
00684   taille_cont = (<a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(cont)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(cont)) ;
00685                    <span class="comment">/* Calcul du resultat *****/</span>
00686       memset( cont, 0, taille_cont );
00687 
00688       <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(cont,0);
00689 
00690   <span class="keywordflow">return</span> cont;
00691 }
00692 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00693 <span class="comment"></span>
00694 <span class="comment">IdCntCopy  (fonction)</span>
00695 <span class="comment"></span>
00696 <span class="comment">RESUME: copie un Contour ds un autre, meme type/longueur</span>
00697 <span class="comment"></span>
00698 <span class="comment">DESCRIPTION: Copie les points d'un Contour dans un autre de meme type et longueur.</span>
00699 <span class="comment"></span>
00700 <span class="comment">SYNTAXE:     PCONTOUR cntDest = IdCntCopy(PCONTOUR cntSource, PCONTOUR cntDest);</span>
00701 <span class="comment"></span>
00702 <span class="comment">RETOUR:      type  : PCONTOUR</span>
00703 <span class="comment">        role  : Pointeur vers le Contour resultat (cntDest).</span>
00704 <span class="comment"></span>
00705 <span class="comment">PARAMETRES:</span>
00706 <span class="comment">        nom   : cntSource</span>
00707 <span class="comment">        type  : PCONTOUR</span>
00708 <span class="comment">        role  : Contour d'origine.</span>
00709 <span class="comment"></span>
00710 <span class="comment">        nom   : cntDest</span>
00711 <span class="comment">        type  : PCONTOUR</span>
00712 <span class="comment">        role  : Contour destination de meme type et dim. que cntSource.</span>
00713 <span class="comment"></span>
00714 <span class="comment">FICHIER:     cntutil.c</span>
00715 <span class="comment"></span>
00716 <span class="comment">EXEMPLE:     if( !IdCntCopy (ims,imd) ) IdErrPrintf(IdErrMsg(IdErrno));</span>
00717 <span class="comment"></span>
00718 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00719"></a><a class="code" href="idcnt-base_8h.html#a6">00719</a> <a class="code" href="idcnt-ido_8h.html#a25">PCONTOUR</a> <a class="code" href="idcnt-base_8h.html#a6">IdCntCopy</a> (ims,imd)
00720 PCONTOUR ims,imd;
00721 {
00722 <span class="comment">/*  int i;*/</span>
00723   <span class="keywordflow">if</span> ( !<a class="code" href="idcnt-ido_8h.html#a16">IdCntSameSizeAndType</a>(ims,imd) )  {
00724     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a13">IDERR_WRONG_DIM</a>;
00725     <span class="keywordflow">return</span> 0;
00726   }
00727      memcpy (imd,ims,<a class="code" href="idcnt-ido_8h.html#a10">IdCntDimX</a>(imd)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(imd));
00728      <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(imd,<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(ims));
00729   <span class="keywordflow">return</span> imd;
00730 }
00731 
00732 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00733 <span class="comment"></span>
00734 <span class="comment">IdCntCast  (fonction)</span>
00735 <span class="comment"></span>
00736 <span class="comment">RESUME: converti un Contour d'un type reel ds un autre</span>
00737 <span class="comment"></span>
00738 <span class="comment">DESCRIPTION: Convertit un Contour d'un type reel dans un autre. Les</span>
00739 <span class="comment">             types sources complexes ne sont pas pris en charge.</span>
00740 <span class="comment">             Dans ce cas, la variable IdErrno prend une valeur non-nulle.</span>
00741 <span class="comment"></span>
00742 <span class="comment">SYNTAXE:     PCONTOUR imDest = IdCntCast(PCONTOUR imSource, PCONTOUR imDest);</span>
00743 <span class="comment"></span>
00744 <span class="comment">RETOUR:      type  : PCONTOUR</span>
00745 <span class="comment">        role  : Pointeur vers le Contour resultat (imd) ou zero si echec.</span>
00746 <span class="comment"></span>
00747 <span class="comment">PARAMETRES:</span>
00748 <span class="comment">        nom   : imSource</span>
00749 <span class="comment">        type  : PCONTOUR</span>
00750 <span class="comment">        role  : Contour d'origine.</span>
00751 <span class="comment"></span>
00752 <span class="comment">        nom   : imDest</span>
00753 <span class="comment">        type  : PCONTOUR</span>
00754 <span class="comment">        role  : Contour destination. Doit etre alloue en utilisant la</span>
00755 <span class="comment">                     fonction IdCntAlloc() avec le bon type CNT_???.</span>
00756 <span class="comment"></span>
00757 <span class="comment">FICHIER:     cntutil.c</span>
00758 <span class="comment"></span>
00759 <span class="comment">EXEMPLE:     if( !IdCntCast (ims,imd) )</span>
00760 <span class="comment">               IdErrPrintf(IdErrMsg(IdErrno));</span>
00761 <span class="comment"></span>
00762 <span class="comment">******************************************************** END DESCRIPTION */</span>
<a name="l00763"></a><a class="code" href="idcnt-base_8h.html#a7">00763</a> <a class="code" href="idcnt-ido_8h.html#a25">PCONTOUR</a> <a class="code" href="idcnt-base_8h.html#a7">IdCntCast</a> (ims,imd)
00764 PCONTOUR ims,imd;
00765 {
00766   <span class="keywordtype">int</span> i;
00767   <span class="keywordflow">if</span> ( !<a class="code" href="idcnt-ido_8h.html#a17">IdCntSameSize</a> (ims,imd)) 
00768   {
00769     <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a13">IDERR_WRONG_DIM</a>;
00770     <span class="keywordflow">return</span> 0;
00771   }
00772   <span class="keywordflow">if</span> (<a class="code" href="idcnt-ido_8h.html#a9">IdCntType</a>(imd)==<a class="code" href="idcnt-ido_8h.html#a9">IdCntType</a>(ims)){
00773     <a class="code" href="idcnt-base_8h.html#a6">IdCntCopy</a>(ims,imd);
00774     <span class="keywordflow">return</span> imd;
00775   }
00776 
00777 <span class="preprocessor">#define CRR(t1,t2)      for(i=0;i&lt;IdCntDimX(ims);i++)          \</span>
00778 <span class="preprocessor">                          { ((t2)imd)[i].x = ((t1)ims)[i].x;      \</span>
00779 <span class="preprocessor">                            ((t2)imd)[i].y = ((t1)ims)[i].y;      \</span>
00780 <span class="preprocessor">                          }</span>
00781 <span class="preprocessor"></span>
00782 <span class="preprocessor">#define CFR(PPt)  switch ( IdCntType(imd) ) {            \</span>
00783 <span class="preprocessor">   case CNT_CHAR     : CRR(PPt,PCONTOUR_CHAR);  break; \</span>
00784 <span class="preprocessor">   case CNT_UCHAR    : CRR(PPt,PCONTOUR_UCHAR);    break; \</span>
00785 <span class="preprocessor">        case CNT_SHORT     : CRR(PPt,PCONTOUR_SHORT);    break; \</span>
00786 <span class="preprocessor">   case CNT_USHORT      : CRR(PPt,PCONTOUR_USHORT);   break; \</span>
00787 <span class="preprocessor">   case CNT_LONG     : CRR(PPt,PCONTOUR_LONG);  break; \</span>
00788 <span class="preprocessor">   case CNT_ULONG    : CRR(PPt,PCONTOUR_ULONG);    break; \</span>
00789 <span class="preprocessor">   case CNT_FLOAT    : CRR(PPt,PCONTOUR_FLOAT);    break; \</span>
00790 <span class="preprocessor">   case CNT_DOUBLE   : CRR(PPt,PCONTOUR_DOUBLE);   break; \</span>
00791 <span class="preprocessor">   default        : IdErrno=IDERR_WRONG_TYPE;      \</span>
00792 <span class="preprocessor">             IdPrintf("Type non Traite1 %x\n",IdCntType(imd) );      \</span>
00793 <span class="preprocessor">            return 0;  }</span>
00794 <span class="preprocessor"></span>
00795   <span class="keywordflow">switch</span> ( <a class="code" href="idcnt-ido_8h.html#a9">IdCntType</a>(ims) ) {
00796     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a1">CNT_UCHAR</a>  : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__UCHAR.html">PCONTOUR_UCHAR</a>); <span class="keywordflow">break</span>;
00797     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a0">CNT_CHAR</a>   : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__CHAR.html">PCONTOUR_CHAR</a>); <span class="keywordflow">break</span>;
00798     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a2">CNT_SHORT</a>  : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__SHORT.html">PCONTOUR_SHORT</a>); <span class="keywordflow">break</span>;
00799     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a3">CNT_USHORT</a> : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__USHORT.html">PCONTOUR_USHORT</a>); <span class="keywordflow">break</span>;
00800     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a4">CNT_LONG</a>   : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__LONG.html">PCONTOUR_LONG</a>); <span class="keywordflow">break</span>;
00801     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a5">CNT_ULONG</a>  : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__ULONG.html">PCONTOUR_ULONG</a>); <span class="keywordflow">break</span>;
00802     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a6">CNT_FLOAT</a>  : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__FLOAT.html">PCONTOUR_FLOAT</a>); <span class="keywordflow">break</span>;
00803     <span class="keywordflow">case</span> <a class="code" href="idcnt-ido_8h.html#a7">CNT_DOUBLE</a> : <a class="code" href="cntutil_8c.html#a1">CFR</a>(<a class="code" href="structIDXPOINT__DOUBLE.html">PCONTOUR_DOUBLE</a>); <span class="keywordflow">break</span>;
00804     <span class="keywordflow">default</span>     : <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00805              <a class="code" href="kerprint_8c.html#a4">IdPrintf</a>(<span class="stringliteral">"Type non Traite2 %x\n"</span>,<a class="code" href="idcnt-ido_8h.html#a9">IdCntType</a>(ims));
00806             <span class="keywordflow">return</span> 0;  }    
00807   <a class="code" href="idcnt-ido_8h.html#a21">IdCntSetUsedNbX</a>(imd,<a class="code" href="idcnt-ido_8h.html#a23">IdCntGetUsedNbX</a>(ims));
00808   <span class="keywordflow">return</span> imd;
00809 }
00810 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 20 14:28:13 2006 for SIMRI3D by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
