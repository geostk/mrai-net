<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SIMRI3D: imagette.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>imagette.c</h1><a href="imagette_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*************************************************************************</span>
00002 <span class="comment">* $Id: imagette.c,v 1.1 2005/09/09 08:22:48 bellet Exp $</span>
00003 <span class="comment">**************************************************************************</span>
00004 <span class="comment"> This software is governed by the CeCILL  license under French law and</span>
00005 <span class="comment">  abiding by the rules of distribution of free software.  You can  use, </span>
00006 <span class="comment">  modify and/ or redistribute the software under the terms of the CeCILL</span>
00007 <span class="comment">  license as circulated by CEA, CNRS and INRIA at the following URL</span>
00008 <span class="comment">  "http://www.cecill.info". </span>
00009 <span class="comment">  </span>
00010 <span class="comment">  As a counterpart to the access to the source code and  rights to copy,</span>
00011 <span class="comment">  modify and redistribute granted by the license, users are provided only</span>
00012 <span class="comment">  with a limited warranty  and the software's author,  the holder of the</span>
00013 <span class="comment">  economic rights,  and the successive licensors  have only  limited</span>
00014 <span class="comment">  liability. </span>
00015 <span class="comment">  </span>
00016 <span class="comment">  In this respect, the user's attention is drawn to the risks associated</span>
00017 <span class="comment">  with loading,  using,  modifying and/or developing or reproducing the</span>
00018 <span class="comment">  software by the user in light of its specific status of free software,</span>
00019 <span class="comment">  that may mean  that it is complicated to manipulate,  and  that  also</span>
00020 <span class="comment">  therefore means  that it is reserved for developers  and  experienced</span>
00021 <span class="comment">  professionals having in-depth computer knowledge. Users are therefore</span>
00022 <span class="comment">  encouraged to load and test the software's suitability as regards their</span>
00023 <span class="comment">  requirements in conditions enabling the security of their systems and/or </span>
00024 <span class="comment">  data to be ensured and,  more generally, to use and operate it in the </span>
00025 <span class="comment">  same conditions as regards security. </span>
00026 <span class="comment">  </span>
00027 <span class="comment">  The fact that you are presently reading this means that you have had</span>
00028 <span class="comment">  knowledge of the CeCILL license and that you accept its terms.</span>
00029 <span class="comment">  </span>
00030 <span class="comment">  Copyright (c) CREATIS (Centre de Recherche et d'Applications en Traitement de</span>
00031 <span class="comment">  l'Image). All rights reserved. See License.txt for details.</span>
00032 <span class="comment">  </span>
00033 <span class="comment">  Version 1.0  05/09/2005</span>
00034 <span class="comment">*************************************************************************/</span>
00035 
00036 <span class="preprocessor">#include &lt;math.h&gt;</span>
00037 <span class="preprocessor">#include &lt;float.h&gt;</span>
00038 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00039 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00040 <span class="preprocessor">#include "<a class="code" href="idima_8h.html">idima.h</a>"</span>
00041 <span class="preprocessor">#include "<a class="code" href="iderr_8h.html">iderr.h</a>"</span>
00042 <span class="preprocessor">#include "<a class="code" href="idprint_8h.html">idprint.h</a>"</span>
00043 
00044 <span class="keyword">static</span> <a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a> imDouble=NULL;
00045 
00046 
00047 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00048 <span class="comment">* </span>
00049 <span class="comment">* IdImaRecadTo8   (fonction)</span>
00050 <span class="comment">* </span>
00051 <span class="comment">* RESUME: Recadre (Dynamique) une image non COMPLEX ds une image 8 bits</span>
00052 <span class="comment">* </span>
00053 <span class="comment">* DESCRIPTION: Recadre (Dynamique) une image non COMPLEX ds une image 8 bits</span>
00054 <span class="comment">* </span>
00055 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR imDest= IdImaRecadTo8 (PPIMAGE imSource, PPIMAGE_UCHAR imDest, double minImpose, double maxImpose);</span>
00056 <span class="comment">* </span>
00057 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00058 <span class="comment">*       role  : ptr sur image recadree.</span>
00059 <span class="comment">* </span>
00060 <span class="comment">* PARAMETRES:  nom   : imSource</span>
00061 <span class="comment">*       type  : PPIMAGE</span>
00062 <span class="comment">*       role  : Pointeur vers l'image source</span>
00063 <span class="comment">* </span>
00064 <span class="comment">*          nom   : imDest</span>
00065 <span class="comment">*       type  : PPIMAGE_UCHAR</span>
00066 <span class="comment">*       role  : Pointeur vers l' Image destination</span>
00067 <span class="comment">* </span>
00068 <span class="comment">*       nom   : minImpose, maxImpose </span>
00069 <span class="comment">*              type  : double</span>
00070 <span class="comment">*       role  : min et max imposes pour le recadrage </span>
00071 <span class="comment">*        : sans effet si -1.0,-1.0</span>
00072 <span class="comment">* </span>
00073 <span class="comment">* FICHIER:     imagette.c</span>
00074 <span class="comment">* </span>
00075 <span class="comment">* EXEMPLE:</span>
00076 <span class="comment">* </span>
00077 <span class="comment">******************************************************** END DESCRIPTION */</span>
00078 
<a name="l00079"></a><a class="code" href="imagette_8c.html#a0">00079</a> <span class="preprocessor">#define FF1(typeima)                               \</span>
00080 <span class="preprocessor">                                       \</span>
00081 <span class="preprocessor">if ( (minImpose!=-1.) &amp;&amp; (maxImpose!=-1.) )                       \</span>
00082 <span class="preprocessor">{                                      \</span>
00083 <span class="preprocessor">   mini=minImpose;      </span><span class="comment">/* imposes; on les prend */</span>                  \
00084    maxi=maxImpose;                                 \
00085                                        \
00086    MM= maxi-mini;                               \
00087    if(MM==0.)                                \
00088             {  IdErrPrintf (" Min = Max  = %g; Impossible recadrer \n",maxi);       \
00089          IdErrno=IDERR_MIN_EQ_MAX;                    \
00090             return 0;                           \
00091           }                               \
00092                                        \
00093       for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00094          for(j=0;j&lt;IdImaDimX(imS);j++)                         \
00095         {                                    \
00096    pixel = (double)(((typeima)imS)[i][j]);                        \
00097    if     (pixel&gt;maxi) imD[i][j]=255;                       \
00098    else if(pixel&lt;mini) imD[i][j]=0;                      \
00099      else {                               \
00100          imD[i][j]=(unsigned char) ( (double)( (pixel-mini)*255 ) /MM );            \
00101       }                                \
00102         }                                    \
00103 }                                      \
00104  else                                     \
00105 {                                      \
00106    maxi= - FLT_MAX;        <span class="comment">/* non imposes, on les cherche */</span>            \
00107    mini=   FLT_MAX;                             \
00108    for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00109     for(j=0;j&lt;IdImaDimX(imS);j++)                           \
00110      { if((((typeima)imS)[i][j]) &gt; maxi) maxi=(((typeima)imS)[i][j]);            \
00111           if((((typeima)imS)[i][j]) &lt; mini) mini=(((typeima)imS)[i][j]);            \
00112      }                                    \
00113                                        \
00114  <span class="comment">/*               Recadrage de l'image       */</span>                      \
00115    MM=maxi-mini;                                \
00116    if(MM==0.)                                \
00117             {  IdErrPrintf (" Min = Max = %g; Impossible recadrer \n",mini);        \
00118          IdErrno=IDERR_MIN_EQ_MAX;                    \
00119             return 0;                           \
00120           }                               \
00121                                        \
00122    for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00123    for(j=0;j&lt;IdImaDimX(imS);j++)                         \
00124       {                                \
00125       imD[i][j]=(unsigned char) ( (double)( ((((typeima)imS)[i][j])-mini)*255 ) /MM ); \
00126       }                                \
00127 }
00128 
00129 
<a name="l00130"></a><a class="code" href="imagette_8c.html#a6">00130</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a6">IdImaRecadTo8</a>(
00131    PPIMAGE imS,
00132    PPIMAGE_UCHAR imD,
00133    <span class="keywordtype">double</span> minImpose,
00134    <span class="keywordtype">double</span> maxImpose)
00135 {
00136 <span class="keywordtype">double</span> mini,maxi;
00137 <span class="keywordtype">double</span> MM;
00138 <span class="keywordtype">double</span> pixel; 
00139 
00140 <span class="keywordtype">int</span> i,j;
00141 
00142 imD=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imachekal_8c.html#a4">IdImaCheckSizeAllocType</a> (imS,-1,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imD,<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00143 
00144             <span class="keywordflow">if</span> (!(imD))
00145             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" IdImaRecadTo8 : echec Alloc Image 8bits \n"</span>);
00146          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00147             <span class="keywordflow">return</span> 0;
00148           }
00149 
00150   <span class="keywordflow">switch</span>(<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS))
00151     {
00152      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a0">IMA_CHAR</a>:   <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a24">PPIMAGE_CHAR</a>);   <span class="keywordflow">break</span>;  
00153      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>:  <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>);  <span class="keywordflow">break</span>;  
00154      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a2">IMA_SHORT</a>:  <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a31">PPIMAGE_SHORT</a>);  <span class="keywordflow">break</span>;  
00155      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>: <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>); <span class="keywordflow">break</span>;  
00156      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a4">IMA_LONG</a>:   <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a33">PPIMAGE_LONG</a>);   <span class="keywordflow">break</span>; 
00157      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a5">IMA_ULONG</a>:  <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a34">PPIMAGE_ULONG</a>);  <span class="keywordflow">break</span>;   
00158      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>:  <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>);  <span class="keywordflow">break</span>;  
00159      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>: <a class="code" href="imagette_8c.html#a0">FF1</a>(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>); <span class="keywordflow">break</span>;  
00160      <span class="keywordflow">default</span>:
00161    <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Type %d non traitable par la fonction IdImaRecadTo8 !\n"</span>, <a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS));
00162    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a15">IDERR_WRONG_LIBTYPE</a>;
00163    <span class="keywordflow">return</span>(0);
00164     } 
00165 
00166 <a class="code" href="kernomfic_8c.html#a1">IdSetFileName</a>(imD,<a class="code" href="kernomfic_8c.html#a0">IdGetFileName</a>(imS));
00167 <span class="keywordflow">return</span> (imD);
00168 }
00169 
00170 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00171 <span class="comment">* </span>
00172 <span class="comment">* IdImaRecadTo8DCT   (fonction)</span>
00173 <span class="comment">* </span>
00174 <span class="comment">* RESUME: Recadre (DCT) une image non COMPLEX ds une image 8 bits</span>
00175 <span class="comment">* </span>
00176 <span class="comment">* DESCRIPTION: Recadre (DCT) une image non COMPLEX ds une image 8 bits</span>
00177 <span class="comment">* </span>
00178 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR imDest= IdImaRecadTo8DCT (PPIMAGE imSource, PPIMAGE_UCHAR imDest);</span>
00179 <span class="comment">* </span>
00180 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00181 <span class="comment">*       role  : ptr sur image recadree</span>
00182 <span class="comment">* </span>
00183 <span class="comment">* PARAMETRES:  nom   : imSource</span>
00184 <span class="comment">*       type  : PPIMAGE</span>
00185 <span class="comment">*       role  : Pointeur vers l'image source</span>
00186 <span class="comment">* </span>
00187 <span class="comment">*          nom   : imDest</span>
00188 <span class="comment">*       type  : PPIMAGE_UCHAR</span>
00189 <span class="comment">*       role  : Pointeur vers l'Image destination ou NULL si a creer</span>
00190 <span class="comment">* </span>
00191 <span class="comment">* FICHIER:     imagette.c</span>
00192 <span class="comment">* </span>
00193 <span class="comment">* EXEMPLE:</span>
00194 <span class="comment">* </span>
00195 <span class="comment">******************************************************** END DESCRIPTION */</span>
00196 
<a name="l00197"></a><a class="code" href="imagette_8c.html#a1">00197</a> <span class="preprocessor">#define FF2(typeima)                               \</span>
00198 <span class="preprocessor">      for(i=0;i&lt;IdImaDimY(imS);i++)                         \</span>
00199 <span class="preprocessor">         for(j=0;j&lt;IdImaDimX(imS);j++)                         \</span>
00200 <span class="preprocessor">      imDouble[i][j]=fabs((double)((typeima)imS)[i][j]);</span>
00201 <span class="preprocessor"></span>
<a name="l00202"></a><a class="code" href="imagette_8c.html#a7">00202</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a7">IdImaRecadTo8DCT</a>(
00203    PPIMAGE imS,
00204    PPIMAGE_UCHAR imD)
00205 {
00206 <span class="keywordtype">double</span> mini,maxi;
00207 <span class="keywordtype">double</span> MM;
00208 
00209 <span class="keywordtype">int</span> i,j;
00210 
00211 imD=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imachekal_8c.html#a4">IdImaCheckSizeAllocType</a> (imS,-1,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imD,<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00212 
00213             <span class="keywordflow">if</span> (!(imD))
00214             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">"echec Alloc Image 8bits \n"</span>);
00215          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00216             <span class="keywordflow">return</span> (0);
00217           }
00218 
00219 imDouble=(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS),<a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>);
00220 
00221             <span class="keywordflow">if</span> (!(imDouble))
00222             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image Double\n"</span>);
00223          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00224             <span class="keywordflow">return</span> 0;
00225           }
00226 
00227   <span class="keywordflow">switch</span>(<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS))
00228     {
00229      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a0">IMA_CHAR</a>:   <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a24">PPIMAGE_CHAR</a>);   <span class="keywordflow">break</span>;  
00230      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>:  <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>);  <span class="keywordflow">break</span>;  
00231      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a2">IMA_SHORT</a>:  <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a31">PPIMAGE_SHORT</a>);  <span class="keywordflow">break</span>;  
00232      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>: <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>); <span class="keywordflow">break</span>;  
00233      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a4">IMA_LONG</a>:   <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a33">PPIMAGE_LONG</a>);   <span class="keywordflow">break</span>; 
00234      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a5">IMA_ULONG</a>:  <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a34">PPIMAGE_ULONG</a>);  <span class="keywordflow">break</span>;  
00235      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>:  <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>);  <span class="keywordflow">break</span>;  
00236      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>: <a class="code" href="imagette_8c.html#a1">FF2</a>(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>); <span class="keywordflow">break</span>;  
00237     
00238      <span class="keywordflow">default</span>:
00239    <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Type %d non traitable par la fonction IdImaRecadTo8DCT !\n"</span>, <a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS));
00240    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a15">IDERR_WRONG_LIBTYPE</a>;
00241    <span class="keywordflow">return</span>(0);
00242     } 
00243 
00244    imDouble[0][0]=0.; <span class="comment">/* On force la valeur DC a 0 */</span>
00245 
00246       <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00247          <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00248          imDouble[i][j]=log(1+imDouble[i][j]);
00249 
00250    maxi= - FLT_MAX;
00251    mini=   FLT_MAX;
00252 
00253    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00254     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00255      { <span class="keywordflow">if</span>(((imDouble)[i][j]) &gt; maxi) maxi=((imDouble)[i][j]);
00256           <span class="keywordflow">if</span>(((imDouble)[i][j]) &lt; mini) mini=((imDouble)[i][j]);
00257      }
00258 
00259  <span class="comment">/*               Recadrage de l'image       */</span>
00260          
00261    MM= maxi-mini;
00262    <span class="keywordflow">if</span>(MM==0.)   
00263       { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max  = %g; Impossible recadrer \n"</span>,maxi);
00264          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;
00265             <span class="keywordflow">return</span> 0;
00266           }
00267  
00268    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00269    <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00270       {
00271       imD[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) ( ( (((imDouble)[i][j])-mini)*255 ) /MM );
00272       }
00273 
00274 <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(imDouble);
00275 
00276 <span class="keywordflow">return</span> (imD);
00277 }
00278 
00279 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00280 <span class="comment">* </span>
00281 <span class="comment">* IdImaRecadTo8LOG   (fonction)</span>
00282 <span class="comment">* </span>
00283 <span class="comment">* RESUME: Recadre (LOG) une image non COMPLEX ds une image 8 bits</span>
00284 <span class="comment">* </span>
00285 <span class="comment">* DESCRIPTION: Recadre (LOG) une image non COMPLEX ds une image 8 bits</span>
00286 <span class="comment">* </span>
00287 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR imDest= IdImaRecadTo8LOG (PPIMAGE imSource, PPIMAGE_UCHAR imDest);</span>
00288 <span class="comment">* </span>
00289 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00290 <span class="comment">*       role  : Pointeur vers l'image recadree</span>
00291 <span class="comment">* </span>
00292 <span class="comment">* PARAMETRES:  nom   : imSource</span>
00293 <span class="comment">*       type  : PPIMAGE</span>
00294 <span class="comment">*       role  : Pointeur vers l'image source</span>
00295 <span class="comment">* </span>
00296 <span class="comment">*          nom   : imDest</span>
00297 <span class="comment">*       type  : PPIMAGE_UCHAR</span>
00298 <span class="comment">*       role  : Pointeur vers l'Image destination ou NULL si a creer</span>
00299 <span class="comment">* </span>
00300 <span class="comment">* FICHIER:     IMAGETTE.c</span>
00301 <span class="comment">* </span>
00302 <span class="comment">* EXEMPLE:</span>
00303 <span class="comment">* </span>
00304 <span class="comment">******************************************************** END DESCRIPTION */</span>
00305 
<a name="l00306"></a><a class="code" href="imagette_8c.html#a2">00306</a> <span class="preprocessor">#define FF3(typeima)                               \</span>
00307 <span class="preprocessor">      for(i=0;i&lt;IdImaDimY(imS);i++)                         \</span>
00308 <span class="preprocessor">         for(j=0;j&lt;IdImaDimX(imS);j++)                         \</span>
00309 <span class="preprocessor">      imDouble[i][j]=fabs((double)((typeima)imS)[i][j]);</span>
00310 <span class="preprocessor"></span> 
<a name="l00311"></a><a class="code" href="imagette_8c.html#a8">00311</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a8">IdImaRecadTo8LOG</a>(
00312    PPIMAGE imS,
00313    PPIMAGE_UCHAR imD)
00314 {
00315 <span class="keywordtype">double</span> mini,maxi;
00316 <span class="keywordtype">double</span> MM;
00317 
00318 <span class="keywordtype">int</span> i,j;
00319 
00320 imD=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imachekal_8c.html#a4">IdImaCheckSizeAllocType</a> (imS,-1,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imD,<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00321 
00322             <span class="keywordflow">if</span> (!(imD))
00323             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image 8bits \n"</span>);
00324          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00325             <span class="keywordflow">return</span> 0;
00326           }
00327 
00328 imDouble=(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS),<a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>);
00329 
00330             <span class="keywordflow">if</span> (!(imDouble))
00331             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image Double\n"</span>);
00332          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00333             <span class="keywordflow">return</span> 0;
00334           }
00335 
00336   <span class="keywordflow">switch</span>(<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS))
00337     {
00338      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a0">IMA_CHAR</a>:   <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a24">PPIMAGE_CHAR</a>);   <span class="keywordflow">break</span>;  
00339      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>:  <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>);  <span class="keywordflow">break</span>;  
00340      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a2">IMA_SHORT</a>:  <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a31">PPIMAGE_SHORT</a>);  <span class="keywordflow">break</span>;  
00341      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>: <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>); <span class="keywordflow">break</span>;  
00342      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a4">IMA_LONG</a>:   <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a33">PPIMAGE_LONG</a>);   <span class="keywordflow">break</span>; 
00343      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a5">IMA_ULONG</a>:  <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a34">PPIMAGE_ULONG</a>);  <span class="keywordflow">break</span>;  
00344      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>:  <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>);  <span class="keywordflow">break</span>;  
00345      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>: <a class="code" href="imagette_8c.html#a2">FF3</a>(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>); <span class="keywordflow">break</span>;  
00346     
00347      <span class="keywordflow">default</span>:
00348    <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Type %d non traitable par la fonction IdImaRecadTo8LOG !\n"</span>, <a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS));
00349    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a15">IDERR_WRONG_LIBTYPE</a>;
00350    <span class="keywordflow">return</span>(0);
00351     }
00352 
00353       <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00354          <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00355          imDouble[i][j]=log(1.+imDouble[i][j]);
00356 
00357    maxi= - FLT_MAX;
00358    mini=   FLT_MAX;
00359 
00360    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00361     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00362      { <span class="keywordflow">if</span>(((imDouble)[i][j]) &gt; maxi) maxi=((imDouble)[i][j]);
00363           <span class="keywordflow">if</span>(((imDouble)[i][j]) &lt; mini) mini=((imDouble)[i][j]);
00364      }
00365 
00366  <span class="comment">/*               Recadrage de l'image       */</span>
00367          
00368    MM= maxi-mini;
00369    <span class="keywordflow">if</span>(MM==0.)   
00370       { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max  = %g; Impossible recadrer \n"</span>,maxi);
00371          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;
00372             <span class="keywordflow">return</span> 0;
00373           }
00374  
00375    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00376    <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00377       {
00378       imD[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) ( ( (((imDouble)[i][j])-mini)*255 ) /MM );
00379       }
00380  
00381 <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(imDouble);
00382 
00383 <span class="keywordflow">return</span> (imD);
00384 }
00385 
00386 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00387 <span class="comment">* </span>
00388 <span class="comment">* IdImaRecadTo8ABS   (fonction)</span>
00389 <span class="comment">* </span>
00390 <span class="comment">* RESUME: Recadre (ABS) une image non COMPLEX ds une image 8 bits</span>
00391 <span class="comment">* </span>
00392 <span class="comment">* DESCRIPTION: Recadre (ABS) une image non COMPLEX ds une image 8 bits</span>
00393 <span class="comment">* </span>
00394 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR imDest= IdImaRecadTo8ABS (PPIMAGE imSource, PPIMAGE_UCHAR imDest);</span>
00395 <span class="comment">* </span>
00396 <span class="comment">* RETOUR     :  type  : PPIMAGE_UCHAR</span>
00397 <span class="comment">*        role  : Pointeur vers l'image destination</span>
00398 <span class="comment">* </span>
00399 <span class="comment">* PARAMETRES :  nom   : imSource</span>
00400 <span class="comment">*        type  : PPIMAGE</span>
00401 <span class="comment">*        role  : Pointeur vers l'image source</span>
00402 <span class="comment">* </span>
00403 <span class="comment">*           nom   : imDest</span>
00404 <span class="comment">*        type  : PPIMAGE_UCHAR</span>
00405 <span class="comment">*        role  : Pointeur vers l'Image destination ou NULL si a creer</span>
00406 <span class="comment">* </span>
00407 <span class="comment">* FICHIER:     IMAGETTE.c</span>
00408 <span class="comment">* </span>
00409 <span class="comment">* EXEMPLE:</span>
00410 <span class="comment">* </span>
00411 <span class="comment">******************************************************** END DESCRIPTION */</span>
00412 
<a name="l00413"></a><a class="code" href="imagette_8c.html#a3">00413</a> <span class="preprocessor">#define FF4(typeima)                               \</span>
00414 <span class="preprocessor">      for(i=0;i&lt;IdImaDimY(imS);i++)                         \</span>
00415 <span class="preprocessor">         for(j=0;j&lt;IdImaDimX(imS);j++)                         \</span>
00416 <span class="preprocessor">      imDouble[i][j]=fabs((double)((typeima)imS)[i][j]);</span>
00417 <span class="preprocessor"></span>
00418 
<a name="l00419"></a><a class="code" href="imagette_8c.html#a9">00419</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a9">IdImaRecadTo8ABS</a>(
00420    PPIMAGE imS,
00421    PPIMAGE_UCHAR imD)
00422 {
00423 <span class="keywordtype">double</span> mini,maxi;
00424 <span class="keywordtype">double</span> MM;
00425 
00426 <span class="keywordtype">int</span> i,j;
00427 
00428 imD=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imachekal_8c.html#a4">IdImaCheckSizeAllocType</a> (imS,-1,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imD,<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00429 
00430             <span class="keywordflow">if</span> (!(imD))
00431             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image 8bits \n"</span>);
00432          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00433             <span class="keywordflow">return</span> 0;
00434           }
00435 
00436 imDouble=(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS),<a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>);
00437 
00438             <span class="keywordflow">if</span> (!(imDouble))
00439             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image Double\n"</span>);
00440          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00441             <span class="keywordflow">return</span> 0;
00442           }
00443 
00444   <span class="keywordflow">switch</span>(<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS))
00445     {
00446      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a0">IMA_CHAR</a>:   <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a24">PPIMAGE_CHAR</a>);   <span class="keywordflow">break</span>;  
00447      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>:  <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>);  <span class="keywordflow">break</span>;  
00448      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a2">IMA_SHORT</a>:  <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a31">PPIMAGE_SHORT</a>);  <span class="keywordflow">break</span>;  
00449      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>: <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>); <span class="keywordflow">break</span>;  
00450      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a4">IMA_LONG</a>:   <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a33">PPIMAGE_LONG</a>);   <span class="keywordflow">break</span>; 
00451      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a5">IMA_ULONG</a>:  <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a34">PPIMAGE_ULONG</a>);  <span class="keywordflow">break</span>;  
00452      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>:  <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>);  <span class="keywordflow">break</span>;  
00453      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>: <a class="code" href="imagette_8c.html#a3">FF4</a>(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>); <span class="keywordflow">break</span>;  
00454     
00455      <span class="keywordflow">default</span>:
00456    <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Type %d non traitable par la fonction IdImaRecadTo8ABS !\n"</span>, <a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS));
00457    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a15">IDERR_WRONG_LIBTYPE</a>;
00458    <span class="keywordflow">return</span>(0);
00459     }
00460 
00461    maxi= - FLT_MAX;
00462    mini=   FLT_MAX;
00463 
00464    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00465     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00466      { <span class="keywordflow">if</span>(((imDouble)[i][j]) &gt; maxi) maxi=((imDouble)[i][j]);
00467           <span class="keywordflow">if</span>(((imDouble)[i][j]) &lt; mini) mini=((imDouble)[i][j]);
00468      }
00469 
00470  <span class="comment">/*               Recadrage de l'image       */</span>
00471          
00472    MM= maxi-mini;
00473    <span class="keywordflow">if</span>(MM==0.)   
00474       { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max  = %g; Impossible recadrer \n"</span>,maxi);
00475          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;
00476             <span class="keywordflow">return</span> 0;
00477           }
00478  
00479    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imS);i++)
00480    <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imS);j++)
00481       {
00482       imD[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) ( ( (((imDouble)[i][j])-mini)*255 ) /MM );
00483       }
00484  
00485 <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(imDouble);
00486 
00487 <span class="keywordflow">return</span> (imD);
00488 }
00489 
00490 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00491 <span class="comment">* </span>
00492 <span class="comment">* IdImaRecad16To8   (fonction)</span>
00493 <span class="comment">* </span>
00494 <span class="comment">* RESUME: recadre une image 16 bits ds une image 8 bits</span>
00495 <span class="comment">* </span>
00496 <span class="comment">* DESCRIPTION: recadre une image 16 bits ds une image 8 bits</span>
00497 <span class="comment">* </span>
00498 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= IdImaRecad16To8 (PPIMAGE_USHORT im16, int minImpose, int maxImpose);</span>
00499 <span class="comment">* </span>
00500 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00501 <span class="comment">*       role  : Pointeur vers l'image destination</span>
00502 <span class="comment">* </span>
00503 <span class="comment">* PARAMETRES:  nom   : im16</span>
00504 <span class="comment">*       type  : PPIMAGE_USHORT</span>
00505 <span class="comment">*       role  : Pointeur vers l'image source</span>
00506 <span class="comment">* </span>
00507 <span class="comment">*       nom   : minImpose, maxImpose </span>
00508 <span class="comment">*              type  : int</span>
00509 <span class="comment">*       role  : min et max imposes pour le recadrage </span>
00510 <span class="comment">*        : sans effet si -1,-1</span>
00511 <span class="comment">* </span>
00512 <span class="comment">* FICHIER:     imagette.c</span>
00513 <span class="comment">* </span>
00514 <span class="comment">* EXEMPLE:</span>
00515 <span class="comment">* </span>
00516 <span class="comment">******************************************************** END DESCRIPTION */</span>
00517 
<a name="l00518"></a><a class="code" href="imagette_8c.html#a10">00518</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a10">IdImaRecad16To8</a>(
00519    PPIMAGE_USHORT im16,
00520    <span class="keywordtype">int</span> minImpose,
00521    <span class="keywordtype">int</span> maxImpose)
00522 {
00523 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> im8;
00524 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mini,maxi;
00525 <span class="keywordtype">float</span> Fmult,MM;
00526 <span class="keywordtype">int</span> i,j;
00527 <span class="keywordflow">if</span> (!im16) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur image 16 bits \n"</span>); <span class="keywordflow">return</span>(0);}
00528 
00529 im8=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16),<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00530             <span class="keywordflow">if</span> (!(im8))
00531             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc image 8bits \n"</span>);
00532             <span class="keywordflow">return</span> 0;
00533           }
00534 <span class="keywordflow">if</span> ( (minImpose!=-1) &amp;&amp; (maxImpose!=-1) )
00535    {
00536    mini=minImpose;      <span class="comment">/* imposes; on les prend */</span>
00537    maxi=maxImpose;
00538 
00539     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)    <span class="comment">/* on remonte a Min tt ce qui est &lt; Min */</span>
00540        <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);j++) <span class="comment">/* on descend a Max tt ce qui est &gt; Max */</span>
00541         { <span class="keywordflow">if</span>     ((<span class="keywordtype">int</span>)im16[i][j]&gt;maxi)im16[i][j]=maxi;
00542           <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&lt;mini)im16[i][j]=mini;
00543         }
00544 
00545 <span class="comment">/*IdPrintf (" min max imposes %d %d\n", minImpose,maxImpose);*/</span>
00546    }
00547  <span class="keywordflow">else</span>
00548    {
00549    maxi=0;        <span class="comment">/* non imposes, on les cherche */</span>
00550    mini=0xffff;
00551    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00552     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00553      { <span class="keywordflow">if</span>(im16[i][j] &gt; maxi) maxi=im16[i][j];
00554           <span class="keywordflow">if</span>(im16[i][j] &lt; mini) mini=im16[i][j];
00555      }
00556 <span class="comment">/*IdPrintf (" min max calcules %d %d\n", mini,maxi);*/</span>
00557       }
00558  <span class="comment">/*               Recadrage de l'image       */</span> 
00559 
00560                                        
00561   MM= maxi-mini;                                
00562   <span class="keywordflow">if</span>(MM==0.)                                 
00563    {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max = %g; Impossible recadrer \n"</span>,mini);           
00564    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;
00565    <span class="keywordflow">return</span> 0;                           
00566    }                                
00567                                        
00568      
00569 
00570 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00571  <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00572   { Fmult=(<span class="keywordtype">float</span>)((im16[i][j]-mini)*255);
00573     im8[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(Fmult/MM);
00574   }
00575 
00576 <a class="code" href="kernomfic_8c.html#a1">IdSetFileName</a>(im8,<a class="code" href="kernomfic_8c.html#a0">IdGetFileName</a>(im16));
00577 
00578 <span class="keywordflow">return</span> (im8);
00579 }
00580 
00581 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00582 <span class="comment">* </span>
00583 <span class="comment">* IdImaRecad16To8IgnoreUpper   (fonction)</span>
00584 <span class="comment">* </span>
00585 <span class="comment">* RESUME: recadre une image 16 bits ds une image 8 bits  en IGNORANT les pixels &gt; val donnee</span>
00586 <span class="comment">* </span>
00587 <span class="comment">* DESCRIPTION: recadre une image 16 bits ds une image 8 bits en </span>
00588 <span class="comment">*     IGNORANT les pixels &gt; val donnee</span>
00589 <span class="comment">*     Les pixels &gt;= valSup seront mis a 255 lors du recadrage,</span>
00590 <span class="comment">*     qui se fera sur [min,max] des pixels restants</span>
00591 <span class="comment">* </span>
00592 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= </span>
00593 <span class="comment">* IdImaRecad16To8IgnoreUpper (PPIMAGE_USHORT im16, int minImpose, int maxImpose, int valSup);</span>
00594 <span class="comment">* </span>
00595 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00596 <span class="comment">*       role  : Pointeur vers l'image destination</span>
00597 <span class="comment">* </span>
00598 <span class="comment">* PARAMETRES:  nom   : im16</span>
00599 <span class="comment">*       type  : PPIMAGE_USHORT</span>
00600 <span class="comment">*       role  : Pointeur vers l'image source</span>
00601 <span class="comment">* </span>
00602 <span class="comment">*       nom   : minImpose, maxImpose </span>
00603 <span class="comment">*              type  : int</span>
00604 <span class="comment">*       role  : min et max imposes pour le recadrage </span>
00605 <span class="comment">*        : sans effet si -1,-1</span>
00606 <span class="comment">* </span>
00607 <span class="comment">*       nom   : valSup </span>
00608 <span class="comment">*              type  : int</span>
00609 <span class="comment">*       role  : les pixels &gt;= valSup seront mis a 255 lors du recadrage,</span>
00610 <span class="comment">*        qui se fera sur [min,max] des pixels restants</span>
00611 <span class="comment">* </span>
00612 <span class="comment">* FICHIER:     imagette.c</span>
00613 <span class="comment">* </span>
00614 <span class="comment">* EXEMPLE:</span>
00615 <span class="comment">* </span>
00616 <span class="comment">******************************************************** END DESCRIPTION */</span>
00617 
<a name="l00618"></a><a class="code" href="imagette_8c.html#a11">00618</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a11">IdImaRecad16To8IgnoreUpper</a>(
00619    PPIMAGE_USHORT im16,
00620    <span class="keywordtype">int</span> minImpose,
00621    <span class="keywordtype">int</span> maxImpose,
00622    <span class="keywordtype">int</span> valSup)
00623 {
00624 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> im8;
00625 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mini,maxi;
00626 <span class="keywordtype">float</span> Fmult,MM;
00627 <span class="keywordtype">int</span> i,j;
00628 <span class="keywordflow">if</span> (!im16) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur image 16 bits \n"</span>); <span class="keywordflow">return</span>(0);}
00629 
00630 im8=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16),<a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
00631             <span class="keywordflow">if</span> (!(im8))
00632             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc image 8bits \n"</span>);
00633             <span class="keywordflow">return</span> 0;
00634           }
00635 <span class="keywordflow">if</span> ( (minImpose!=-1) &amp;&amp; (maxImpose!=-1) )
00636    {
00637    mini=minImpose;      <span class="comment">/* imposes; on les prend */</span>
00638    maxi=maxImpose;
00639 
00640     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)    <span class="comment">/* on remonte a Min tt ce qui est &lt; Min */</span>
00641        <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);j++) <span class="comment">/* on descend a Max tt ce qui est &gt; Max */</span>
00642         { 
00643    <span class="keywordflow">if</span>     ((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup) <span class="keywordflow">continue</span>;
00644    <span class="keywordflow">if</span>     ((<span class="keywordtype">int</span>)im16[i][j]&gt;maxi)im16[i][j]=maxi;
00645           <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&lt;mini)im16[i][j]=mini;
00646         }
00647 
00648    }
00649  <span class="keywordflow">else</span>
00650    {
00651    maxi=0;        <span class="comment">/* non imposes, on les cherche */</span>
00652    mini=0xffff;
00653    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00654     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00655      { 
00656        <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup) <span class="keywordflow">continue</span>;
00657        <span class="keywordflow">if</span>(im16[i][j] &gt; maxi) maxi=im16[i][j];
00658           <span class="keywordflow">if</span>(im16[i][j] &lt; mini) mini=im16[i][j];
00659      }
00660       }
00661  <span class="comment">/*               Recadrage de l'image       */</span>      
00662 
00663 
00664                                        
00665    MM= maxi-mini;                               
00666    <span class="keywordflow">if</span>(MM==0.)
00667             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max; Impossible recadrer \n"</span>);            
00668          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;                    
00669             <span class="keywordflow">return</span> 0;                           
00670           }
00671             
00672 
00673 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00674  <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00675   { 
00676     <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup) { im8[i][j]=255; <span class="keywordflow">continue</span>; }
00677     Fmult=(<span class="keywordtype">float</span>)((im16[i][j]-mini)*255);
00678     im8[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(Fmult/MM);
00679   }
00680 
00681 <a class="code" href="kernomfic_8c.html#a1">IdSetFileName</a>(im8,<a class="code" href="kernomfic_8c.html#a0">IdGetFileName</a>(im16));
00682 
00683 <span class="keywordflow">return</span> (im8);
00684 }
00685 
00686 
00687 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00688 <span class="comment">* </span>
00689 <span class="comment">* IdImaRecad16To16IgnoreUpper   (fonction)</span>
00690 <span class="comment">* </span>
00691 <span class="comment">* RESUME: recadre une image 16 bits ds une image 16 bits  en IGNORANT les pixels &gt; val donnee</span>
00692 <span class="comment">* </span>
00693 <span class="comment">* DESCRIPTION: recadre une image 16 bits ds une image 16 bits  (!!!)en </span>
00694 <span class="comment">*     IGNORANT les pixels &gt; val donnee</span>
00695 <span class="comment">*     Les pixels &gt;= valSup seront mis a 4095 lors du recadrage,</span>
00696 <span class="comment">*     qui se fera sur [min,max] des pixels restants</span>
00697 <span class="comment">* </span>
00698 <span class="comment">* SYNTAXE:    PPIMAGE_USHORT imd16= </span>
00699 <span class="comment">* IdImaRecad16To16IgnoreUpper (PPIMAGE_USHORT ims16, int minImpose, int maxImpose, int valSup);</span>
00700 <span class="comment">* </span>
00701 <span class="comment">* RETOUR    :  type  : PPIMAGE_USHORT</span>
00702 <span class="comment">*       role  : Pointeur vers l'image destination</span>
00703 <span class="comment">* </span>
00704 <span class="comment">* PARAMETRES:  nom   : ims16</span>
00705 <span class="comment">*       type  : PPIMAGE_USHORT</span>
00706 <span class="comment">*       role  : Pointeur vers l'image source</span>
00707 <span class="comment">* </span>
00708 <span class="comment">*       nom   : minImpose, maxImpose </span>
00709 <span class="comment">*              type  : int</span>
00710 <span class="comment">*       role  : min et max imposes pour le recadrage </span>
00711 <span class="comment">*        : sans effet si -1,-1</span>
00712 <span class="comment">* </span>
00713 <span class="comment">*       nom   : valSup </span>
00714 <span class="comment">*              type  : int</span>
00715 <span class="comment">*       role  : les pixels &gt;= valSup seront mis a 4095 lors du recadrage,</span>
00716 <span class="comment">*        qui se fera sur [min,max] des pixels restants</span>
00717 <span class="comment">* </span>
00718 <span class="comment">* FICHIER:     imagette.c</span>
00719 <span class="comment">* </span>
00720 <span class="comment">* EXEMPLE:</span>
00721 <span class="comment">* </span>
00722 <span class="comment">******************************************************** END DESCRIPTION */</span>
00723 
<a name="l00724"></a><a class="code" href="imagette_8c.html#a12">00724</a> <a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a> <a class="code" href="imagette_8c.html#a12">IdImaRecad16To16IgnoreUpper</a>(
00725    PPIMAGE_USHORT im16,
00726    <span class="keywordtype">int</span> minImpose,
00727    <span class="keywordtype">int</span> maxImpose,
00728    <span class="keywordtype">int</span> valSup)
00729 {
00730 <a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a> im8;
00731 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mini,maxi;
00732 <span class="keywordtype">float</span> Fmult,MM;
00733 <span class="keywordtype">int</span> i,j;
00734 <span class="keywordflow">if</span> (!im16) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur image 16 bits \n"</span>); <span class="keywordflow">return</span>(0);}
00735 
00736 <span class="comment">/* ATTENTION AUX COMMENTAIRES : im8 est USHORT ... */</span>
00737 
00738 im8=(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16),<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16),<a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>);
00739             <span class="keywordflow">if</span> (!(im8))
00740             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc image 16 bits \n"</span>);
00741             <span class="keywordflow">return</span> 0;
00742           }
00743 <span class="keywordflow">if</span> ( (minImpose!=-1) &amp;&amp; (maxImpose!=-1) )
00744    {
00745    mini=minImpose;      <span class="comment">/* imposes; on les prend */</span>
00746    maxi=maxImpose;
00747 
00748     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)    <span class="comment">/* on remonte a Min tt ce qui est &lt; Min */</span>
00749        <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);j++) <span class="comment">/* on descend a Max tt ce qui est &gt; Max */</span>
00750         { 
00751    <span class="keywordflow">if</span>       ((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup)  <span class="keywordflow">continue</span>;
00752    <span class="keywordflow">if</span>       ((<span class="keywordtype">int</span>)im16[i][j]&gt;maxi)     im16[i][j]=maxi;
00753           <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&lt;mini)      im16[i][j]=mini;
00754         }
00755 
00756    }
00757  <span class="keywordflow">else</span>
00758    {
00759    maxi=0;        <span class="comment">/* non imposes, on les cherche */</span>
00760    mini=0xffff;
00761    <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00762     <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00763      { 
00764        <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup) <span class="keywordflow">continue</span>;
00765        <span class="keywordflow">if</span>(im16[i][j] &gt; maxi) maxi=im16[i][j];
00766           <span class="keywordflow">if</span>(im16[i][j] &lt; mini) mini=im16[i][j];
00767      }
00768       }
00769  <span class="comment">/*               Recadrage de l'image       */</span>
00770                                        
00771    MM= maxi-mini;                               
00772    <span class="keywordflow">if</span>(MM==0.)
00773             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" Min = Max; Impossible recadrer \n"</span>);            
00774          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a49">IDERR_MIN_EQ_MAX</a>;                    
00775             <span class="keywordflow">return</span> 0;                           
00776           }
00777             
00778 
00779 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im16);i++)
00780  <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im16);j++)  
00781   { 
00782     <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)im16[i][j]&gt;=valSup) { im8[i][j]=4095; <span class="keywordflow">continue</span>; }
00783     Fmult=(<span class="keywordtype">float</span>)((im16[i][j]-mini)*4095);
00784     im8[i][j]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)(Fmult/MM);
00785   }
00786 
00787 <a class="code" href="kernomfic_8c.html#a1">IdSetFileName</a>(im8,<a class="code" href="kernomfic_8c.html#a0">IdGetFileName</a>(im16));
00788 
00789 <span class="keywordflow">return</span> (im8);
00790 }
00791 
00792 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00793 <span class="comment">* </span>
00794 <span class="comment">* IdImaRecadTo16   (fonction)</span>
00795 <span class="comment">* </span>
00796 <span class="comment">* RESUME: Recadre (Dynamique) une image non COMPLEX ds une image 16 bits</span>
00797 <span class="comment">* </span>
00798 <span class="comment">* DESCRIPTION: Recadre (Dynamique) une image non COMPLEX ds une image 16 bits</span>
00799 <span class="comment">* </span>
00800 <span class="comment">* SYNTAXE:    PPIMAGE_USHORT imDest= IdImaRecadTo16 (PPIMAGE imSource, PPIMAGE_USHORT imDest, double minImpose, double maxImpose);</span>
00801 <span class="comment">* </span>
00802 <span class="comment">* RETOUR    :  type  : PPIMAGE_USHORT</span>
00803 <span class="comment">*       role  : ptr sur image recadree.</span>
00804 <span class="comment">* </span>
00805 <span class="comment">* PARAMETRES:  nom   : imSource</span>
00806 <span class="comment">*       type  : PPIMAGE</span>
00807 <span class="comment">*       role  : Pointeur vers l'image source</span>
00808 <span class="comment">* </span>
00809 <span class="comment">*          nom   : imDest</span>
00810 <span class="comment">*       type  : PPIMAGE_USHORT</span>
00811 <span class="comment">*       role  : Pointeur vers l' Image destination</span>
00812 <span class="comment">* </span>
00813 <span class="comment">*       nom   : minImpose, maxImpose </span>
00814 <span class="comment">*              type  : double</span>
00815 <span class="comment">*       role  : min et max imposes pour le recadrage </span>
00816 <span class="comment">*        : sans effet si -1.0,-1.0</span>
00817 <span class="comment">* </span>
00818 <span class="comment">* FICHIER:     imagette.c</span>
00819 <span class="comment">* </span>
00820 <span class="comment">* EXEMPLE:</span>
00821 <span class="comment">* </span>
00822 <span class="comment">******************************************************** END DESCRIPTION */</span>
00823 
<a name="l00824"></a><a class="code" href="imagette_8c.html#a4">00824</a> <span class="preprocessor">#define FF6(typeima)                               \</span>
00825 <span class="preprocessor">                                       \</span>
00826 <span class="preprocessor">if ( (minImpose!=-1.) &amp;&amp; (maxImpose!=-1.) )                       \</span>
00827 <span class="preprocessor">{                                      \</span>
00828 <span class="preprocessor">   mini=minImpose;      </span><span class="comment">/* imposes; on les prend */</span>                  \
00829    maxi=maxImpose;                                 \
00830                                        \
00831    MM= maxi-mini;                               \
00832    if(MM==0.)                                \
00833             {  IdErrPrintf (" Min = Max  = %g; Impossible recadrer \n",maxi);       \
00834          IdErrno=IDERR_MIN_EQ_MAX;                    \
00835             return 0;                           \
00836           }                               \
00837                                        \
00838       for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00839          for(j=0;j&lt;IdImaDimX(imS);j++)                         \
00840         {                                    \
00841    pixel = (double)(((typeima)imS)[i][j]);                        \
00842    if     (pixel&gt;maxi) imD[i][j]=32767;                        \
00843    else if(pixel&lt;mini) imD[i][j]=0;                      \
00844      else {                               \
00845          imD[i][j]=(unsigned short) ( (double)( (pixel-mini)*32767. ) /MM );        \
00846       }                                \
00847         }                                    \
00848 }                                      \
00849  else                                     \
00850 {                                      \
00851    maxi= - FLT_MAX;        <span class="comment">/* non imposes, on les cherche */</span>            \
00852    mini=   FLT_MAX;                             \
00853    for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00854     for(j=0;j&lt;IdImaDimX(imS);j++)                           \
00855      { if((((typeima)imS)[i][j]) &gt; maxi) maxi=(((typeima)imS)[i][j]);            \
00856           if((((typeima)imS)[i][j]) &lt; mini) mini=(((typeima)imS)[i][j]);            \
00857      }                                    \
00858                                        \
00859  <span class="comment">/*               Recadrage de l'image       */</span>                      \
00860    MM=maxi-mini;                                \
00861    if(MM==0.)                                \
00862             {  IdErrPrintf (" Min = Max = %g; Impossible recadrer \n",mini);        \
00863          IdErrno=IDERR_MIN_EQ_MAX;                    \
00864             return 0;                           \
00865           }                               \
00866                                        \
00867    for(i=0;i&lt;IdImaDimY(imS);i++)                         \
00868    for(j=0;j&lt;IdImaDimX(imS);j++)                         \
00869       {                                \
00870       imD[i][j]=(unsigned short) ( (double)( ((((typeima)imS)[i][j])-mini)*32767. ) /MM );   \
00871       }                                \
00872 }
00873 
00874 
<a name="l00875"></a><a class="code" href="imagette_8c.html#a13">00875</a> <a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a> <a class="code" href="imagette_8c.html#a13">IdImaRecadTo16</a>(
00876    PPIMAGE imS,
00877    PPIMAGE_USHORT imD,
00878    <span class="keywordtype">double</span> minImpose,
00879    <span class="keywordtype">double</span> maxImpose)
00880 {
00881 <span class="keywordtype">double</span> mini,maxi;
00882 <span class="keywordtype">double</span> MM;
00883 <span class="keywordtype">double</span> pixel; 
00884 
00885 <span class="keywordtype">int</span> i,j;
00886 
00887 imD=(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>)<a class="code" href="imachekal_8c.html#a4">IdImaCheckSizeAllocType</a> (imS,-1,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imD,<a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>);
00888 
00889             <span class="keywordflow">if</span> (!(imD))
00890             {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a> (<span class="stringliteral">" echec Alloc Image 16bits \n"</span>);
00891          <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
00892             <span class="keywordflow">return</span> 0;
00893           }
00894 
00895   <span class="keywordflow">switch</span>(<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS))
00896     {
00897      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a0">IMA_CHAR</a>:   <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a24">PPIMAGE_CHAR</a>);   <span class="keywordflow">break</span>;  
00898      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>:  <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>);  <span class="keywordflow">break</span>;  
00899      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a2">IMA_SHORT</a>:  <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a31">PPIMAGE_SHORT</a>);  <span class="keywordflow">break</span>;  
00900      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a3">IMA_USHORT</a>: <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a32">PPIMAGE_USHORT</a>); <span class="keywordflow">break</span>;  
00901      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a4">IMA_LONG</a>:   <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a33">PPIMAGE_LONG</a>);   <span class="keywordflow">break</span>; 
00902      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a5">IMA_ULONG</a>:  <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a34">PPIMAGE_ULONG</a>);  <span class="keywordflow">break</span>;   
00903      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a6">IMA_FLOAT</a>:  <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a26">PPIMAGE_FLOAT</a>);  <span class="keywordflow">break</span>;  
00904      <span class="keywordflow">case</span> <a class="code" href="idima-ido_8h.html#a7">IMA_DOUBLE</a>: <a class="code" href="imagette_8c.html#a4">FF6</a>(<a class="code" href="idima-ido_8h.html#a27">PPIMAGE_DOUBLE</a>); <span class="keywordflow">break</span>;  
00905      <span class="keywordflow">default</span>:
00906    <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Type %d non traitable par la fonction IdImaRecadTo16 !\n"</span>, <a class="code" href="imabasic_8c.html#a7">IdImaType</a>(imS));
00907    <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a15">IDERR_WRONG_LIBTYPE</a>;
00908    <span class="keywordflow">return</span>(0);
00909     } 
00910 
00911 <a class="code" href="kernomfic_8c.html#a1">IdSetFileName</a>(imD,<a class="code" href="kernomfic_8c.html#a0">IdGetFileName</a>(imS));
00912 <span class="keywordflow">return</span> (imD);
00913 }
00914 
00915 
00916 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
00917 <span class="comment">* </span>
00918 <span class="comment">* IdImaConcat   (fonction)</span>
00919 <span class="comment">* </span>
00920 <span class="comment">* RESUME: concatenne 2 im. 8 bits ds une image 8 bits SANS duplication de pixels</span>
00921 <span class="comment">* </span>
00922 <span class="comment">* DESCRIPTION: concatenne 2 im. 8 bits ds une image 8 bits SANS duplication de pixels. </span>
00923 <span class="comment">*  Si l'une des 2 images est = NULL la fonction retourne un pointeur sur l'autre.</span>
00924 <span class="comment">* </span>
00925 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR imRes= IdImaConcat (PPIMAGE_UCHAR im1,PPIMAGE_UCHAR im2);</span>
00926 <span class="comment">* </span>
00927 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
00928 <span class="comment">*       role  : Pointeur vers les images destination</span>
00929 <span class="comment">* </span>
00930 <span class="comment">* PARAMETRES:  nom   : im1, im2</span>
00931 <span class="comment">*       type  : PPIMAGE_UCHAR</span>
00932 <span class="comment">*       role  : Pointeur vers les images source</span>
00933 <span class="comment">* </span>
00934 <span class="comment">* FICHIER:     imagette.c</span>
00935 <span class="comment">* </span>
00936 <span class="comment">* EXEMPLE:</span>
00937 <span class="comment">* </span>
00938 <span class="comment">******************************************************** END DESCRIPTION */</span>
00939 
<a name="l00940"></a><a class="code" href="imagette_8c.html#a14">00940</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a14">IdImaConcat</a>(
00941    PPIMAGE_UCHAR im1,
00942    PPIMAGE_UCHAR im2)
00943 {
00944 <span class="keywordtype">int</span> nbLigIm1=0,nbLigIm2=0,nbLigIm3,nbColIm1,nbColIm2;
00945 <span class="keywordtype">int</span> j,y,j2;
00946   <a class="code" href="structPRIVATE__IMAGE.html">PRIVATE_IMAGE</a> * si;
00947   <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> im3=NULL;
00948 <span class="keywordflow">if</span>(im1)
00949    {  <span class="keywordflow">if</span> (( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(im1) != <a class="code" href="idgen_8h.html#a7">IMA</a>) )
00950 
00951       {    <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00952                    <span class="keywordflow">return</span>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)0;
00953       }
00954       nbLigIm1=<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im1);
00955       nbColIm1=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im1);
00956    }
00957    <span class="keywordflow">else</span>  nbColIm1=0;
00958 
00959 <span class="keywordflow">if</span>(im2)
00960    {  <span class="keywordflow">if</span> (( <a class="code" href="idgen_8h.html#a84">IdLibidoType</a>(im2) != <a class="code" href="idgen_8h.html#a7">IMA</a>) )
00961 
00962       {    <a class="code" href="iderr_8h.html#a65">IdErrno</a> = <a class="code" href="iderr_8h.html#a11">IDERR_WRONG_TYPE</a>;
00963                    <span class="keywordflow">return</span>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)0;
00964       }
00965       nbLigIm2=<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(im2);
00966       nbColIm2=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im2);
00967 
00968    }
00969    <span class="keywordflow">else</span>  nbColIm2=0;
00970 
00971 <span class="keywordflow">if</span> ( !im1 &amp;&amp; !im2 ) <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)0;
00972 <span class="keywordflow">if</span> ( im1 &amp;&amp; im2 )
00973 {
00974    <span class="keywordflow">if</span> (nbColIm1!=nbColIm2) 
00975       {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur taille images\n"</span>);
00976          <span class="keywordflow">return</span>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)0;
00977       }
00978    <span class="keywordflow">if</span> (<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(im1)!=<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(im2))
00979       {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur: types images #\n"</span>);
00980          <span class="keywordflow">return</span>(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)0;
00981       }
00982 }
00983 
00984  nbLigIm3=nbLigIm1+nbLigIm2;
00985 
00986  si=(<a class="code" href="structPRIVATE__IMAGE.html">PRIVATE_IMAGE</a> *)calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="structPRIVATE__IMAGE.html">PRIVATE_IMAGE</a>) + nbLigIm3*<span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));
00987   <span class="keywordflow">if</span>(si){
00988       <span class="keywordflow">if</span>(im1) si-&gt;<a class="code" href="structPRIVATE__IMAGE.html#o4">DimX</a>=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im1); <span class="keywordflow">else</span> si-&gt;<a class="code" href="structPRIVATE__IMAGE.html#o4">DimX</a>=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(im2);
00989       si-&gt;<a class="code" href="structPRIVATE__IMAGE.html#o3">DimY</a>=nbLigIm3;
00990       <span class="keywordflow">if</span>(im1) si-&gt;<a class="code" href="structPRIVATE__IMAGE.html#o9">Type</a>=<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(im1); <span class="keywordflow">else</span> si-&gt;<a class="code" href="structPRIVATE__IMAGE.html#o9">Type</a>=<a class="code" href="imabasic_8c.html#a7">IdImaType</a>(im2);
00991       im3 = (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)&amp;(si[1]);
00992 
00993    <span class="keywordflow">if</span> (im1)
00994       {
00995          <span class="keywordflow">for</span> ( j=0 ;j&lt;nbLigIm1; j++ )
00996                im3[j]= im1[j];
00997          j2=j;
00998       }
00999       <span class="keywordflow">else</span> j2=0;
01000    <span class="keywordflow">if</span> (im2)
01001       {
01002          <span class="keywordflow">for</span> ( y=0, j=j2; y&lt;nbLigIm2; y++, j++ )
01003                im3[j]= im2[y];
01004             }
01005    }
01006    <span class="keywordflow">else</span> <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec alloc im3\n"</span>);
01007 <span class="keywordflow">return</span> (im3);
01008 
01009 }
01010 
01011 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
01012 <span class="comment">* </span>
01013 <span class="comment">* IdImaCreImagette   (fonction)</span>
01014 <span class="comment">* </span>
01015 <span class="comment">* RESUME: cree une imagette (ligne) a partir d'un tableau de pointeurs sur images</span>
01016 <span class="comment">* </span>
01017 <span class="comment">* DESCRIPTION:  cree une imagette a partir d'un tableau de pointeurs sur images</span>
01018 <span class="comment">* </span>
01019 <span class="comment">* </span>
01020 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= IdImaCreImagette ( PPIMAGE_UCHAR tabImages[], int nbImages,int tailleX , int tailleY);</span>
01021 <span class="comment">* </span>
01022 <span class="comment">* RETOUR    :  type  : PPIMAGE_UCHAR</span>
01023 <span class="comment">*       role  : Pointeur vers le tableau d'images destination</span>
01024 <span class="comment">* </span>
01025 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01026 <span class="comment">*       type  : PPIMAGE_UCHAR *</span>
01027 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01028 <span class="comment">* </span>
01029 <span class="comment">*       nom   : nbImages </span>
01030 <span class="comment">*       type  : int </span>
01031 <span class="comment">*       role  : nb d'images ds le tableau</span>
01032 <span class="comment">* </span>
01033 <span class="comment">*       nom   : tailleX </span>
01034 <span class="comment">*       type  : int </span>
01035 <span class="comment">*       role  : taille en X des images sous-echantillonnees</span>
01036 <span class="comment">* </span>
01037 <span class="comment">*       nom   : tailleY </span>
01038 <span class="comment">*       type  : int </span>
01039 <span class="comment">*       role  : taille en Y des images sous-echantillonnees</span>
01040 <span class="comment">* </span>
01041 <span class="comment">* FICHIER:     imagette.c</span>
01042 <span class="comment">* </span>
01043 <span class="comment">* EXEMPLE:</span>
01044 <span class="comment">* </span>
01045 <span class="comment">******************************************************** END DESCRIPTION */</span>
01046 
<a name="l01047"></a><a class="code" href="imagette_8c.html#a15">01047</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a15">IdImaCreImagette</a>(
01048    PPIMAGE_UCHAR *TabImage,
01049    <span class="keywordtype">int</span> n,
01050    <span class="keywordtype">int</span> nx,
01051    <span class="keywordtype">int</span> ny)
01052 {
01053 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imgtte;
01054 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imaint;
01055 <span class="keywordtype">int</span> i,j,l;
01056 <span class="keywordtype">int</span> TAILLE_X = nx;
01057 <span class="keywordtype">int</span> TAILLE_Y = ny;
01058 imgtte=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(TAILLE_X*n,TAILLE_Y,<a class="code" href="idgen_8h.html#a26">TY_UCHAR</a>);
01059 <span class="keywordflow">if</span>(!imgtte) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec allocation imagette\n"</span>); <span class="keywordflow">return</span> (NULL);}
01060 
01061 imaint=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(TAILLE_X,TAILLE_Y,<a class="code" href="idgen_8h.html#a26">TY_UCHAR</a>);
01062 <span class="keywordflow">if</span>(!imaint) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec allocation image reduite\n"</span>); <span class="keywordflow">return</span> (NULL);}
01063 
01064 <span class="keywordflow">for</span> (l=0;l&lt;n;l++)
01065    {  <a class="code" href="imazoom_8c.html#a1">IdImaZoom</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imaint,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)(TabImage[l]));
01066 
01067    <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imaint);i++)   
01068      <span class="keywordflow">for</span> (j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint);j++)
01069      {   imgtte[i][l*<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint)+j]=imaint[i][j];
01070      }
01071         }
01072 <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(imaint);   
01073 <span class="keywordflow">return</span>(imgtte);
01074 }
01075 
01076 <span class="comment">/* ------------------------------------------------------------------------*/</span>
<a name="l01077"></a><a class="code" href="imagette_8c.html#a16">01077</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a16">_IdImaCreImagetteClear</a>(
01078    PPIMAGE_UCHAR *TabImage,
01079    <span class="keywordtype">int</span> n,      <span class="comment">// Number of allocated positions</span>
01080    <span class="keywordtype">int</span> neffectif, <span class="comment">// Number of images to be stored</span>
01081    <span class="keywordtype">int</span> nx,
01082    <span class="keywordtype">int</span> ny)
01083 {
01084 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imgtte;
01085 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imaint;
01086 <span class="keywordtype">int</span> i,j,l;
01087 <span class="keywordtype">int</span> TAILLE_X = nx;
01088 <span class="keywordtype">int</span> TAILLE_Y = ny;
01089 imgtte=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(TAILLE_X*n,TAILLE_Y,<a class="code" href="idgen_8h.html#a26">TY_UCHAR</a>);
01090 <span class="keywordflow">if</span>(!imgtte) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec allocation imagette\n"</span>); <span class="keywordflow">return</span> (NULL);}
01091 <a class="code" href="imaclear_8c.html#a1">IdImaClear</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imgtte);
01092 
01093 imaint=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(TAILLE_X,TAILLE_Y,<a class="code" href="idgen_8h.html#a26">TY_UCHAR</a>);
01094 <span class="keywordflow">if</span>(!imaint) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec allocation image reduite\n"</span>); <span class="keywordflow">return</span> (NULL);}
01095 
01096 <span class="keywordflow">for</span> (l=0;l&lt;neffectif;l++)
01097    {  <a class="code" href="imazoom_8c.html#a1">IdImaZoom</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imaint,(<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)(TabImage[l]));
01098 
01099 
01100    <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imaint);i++)   
01101      <span class="keywordflow">for</span> (j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint);j++)
01102      {   imgtte[i][l*<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint)+j]=imaint[i][j];
01103      }
01104 
01105         }
01106 <a class="code" href="idima-base_8h.html#a0">IdImaFree</a>(imaint);
01107 <span class="keywordflow">return</span>(imgtte);
01108 }
01109 
01110 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
01111 <span class="comment">* </span>
01112 <span class="comment">* IdImaCreImagetteXY   (fonction)</span>
01113 <span class="comment">* </span>
01114 <span class="comment">* RESUME: cree une imagette(matrice) a partir d'un tableau de pointeurs sur images</span>
01115 <span class="comment">* </span>
01116 <span class="comment">* DESCRIPTION:  cree une imagette a partir d'un tableau de pointeurs sur images</span>
01117 <span class="comment">* </span>
01118 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= IdImaCreeImagetteXY (PPIMAGE_UCHAR tabImages[] , int nbImages, int nbImLig, int nbImCol, int Xsize, int Ysize);</span>
01119 <span class="comment">* </span>
01120 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01121 <span class="comment">*       type  : PPIMAGE_UCHAR *</span>
01122 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01123 <span class="comment">* </span>
01124 <span class="comment">*       nom   : nbImages </span>
01125 <span class="comment">*       type  : int </span>
01126 <span class="comment">*       role  : nb d'images ds le tableau</span>
01127 <span class="comment">* </span>
01128 <span class="comment">*       nom   : nbImLig </span>
01129 <span class="comment">*       type  : int </span>
01130 <span class="comment">*       role  : nombre d'imagettes par LIGNE (si -1, on ajuste)</span>
01131 <span class="comment">* </span>
01132 <span class="comment">*       nom   : nbImCol </span>
01133 <span class="comment">*       type  : int </span>
01134 <span class="comment">*       role  :  nombre d'imagettes par COLONNE (si -1, on ajuste)</span>
01135 <span class="comment">* </span>
01136 <span class="comment">*       nom   : Xsize </span>
01137 <span class="comment">*       type  : int </span>
01138 <span class="comment">*       role  : taille en X des images sous-echantillonnees</span>
01139 <span class="comment">* </span>
01140 <span class="comment">*       nom   : Ysize </span>
01141 <span class="comment">*       type  : int </span>
01142 <span class="comment">*       role  :  taille en Y des images sous-echantillonnees</span>
01143 <span class="comment">* </span>
01144 <span class="comment">* FICHIER:     imagette.c</span>
01145 <span class="comment">* </span>
01146 <span class="comment">* EXEMPLE:</span>
01147 <span class="comment">* </span>
01148 <span class="comment">******************************************************** END DESCRIPTION */</span>
01149 
<a name="l01150"></a><a class="code" href="imagette_8c.html#a17">01150</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a17">IdImaCreImagetteXY</a> (
01151    PPIMAGE_UCHAR *tabimage,
01152    <span class="keywordtype">int</span> nb,     <span class="comment">// Number of images</span>
01153    <span class="keywordtype">int</span> XSIZE,  <span class="comment">// X-size of reduced images</span>
01154    <span class="keywordtype">int</span> YSIZE,  <span class="comment">// Y-size of reduced images</span>
01155    <span class="keywordtype">int</span> nx,     <span class="comment">// Number of images within each line</span>
01156    <span class="keywordtype">int</span> ny)     <span class="comment">// Number of images within each column</span>
01157 
01158 {
01159 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imagettes=0;       <span class="comment">/* image finale a retourner          */</span>
01160 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> ligne_imagettes=0; <span class="comment">/* im auxiliaire lignes d'imagettes  */</span>
01161 <span class="keywordtype">int</span>  m,k,FLAG_COL=0;
01162 
01163      <span class="keywordflow">if</span> ( (nx!=-1)&amp;&amp;(ny!=-1) )  <span class="keywordflow">if</span> (nb&gt;(nx*ny))   nx=(<span class="keywordtype">int</span>)sqrt((<span class="keywordtype">double</span>)nb);
01164 
01165      <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny==-1) ) { nx=nb; ny=1; FLAG_COL=1;}
01166 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (ny==-1)&amp;&amp;(nx!=-1) ) { ny=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)nx) ); }
01167 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny!=-1) ) { nx=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)ny) ); }
01168 
01169 
01170 <span class="keywordflow">if</span>(nb&lt;nx) k=nb; <span class="keywordflow">else</span> k=nx;
01171 
01172 ligne_imagettes =(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imagette_8c.html#a15">IdImaCreImagette</a> (&amp;tabimage[0], k, XSIZE, YSIZE);
01173 
01174 <span class="keywordflow">if</span> (FLAG_COL)   <span class="keywordflow">return</span>(ligne_imagettes);
01175 <span class="keywordflow">if</span> (k==nb) <span class="keywordflow">return</span>(ligne_imagettes);
01176 
01177 imagettes=ligne_imagettes;
01178 
01179 FLAG_COL=0;
01180 <span class="keywordflow">for</span> (m=nx; m&lt;nb; m+=nx)
01181 {
01182 <span class="keywordflow">if</span> ((m+nx)&gt;nb){ FLAG_COL=1; k=nx -(nx*ny-nb) ;<span class="keywordflow">break</span>;}
01183 
01184             ligne_imagettes =(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imagette_8c.html#a15">IdImaCreImagette</a> (&amp;tabimage[m], nx, XSIZE, YSIZE);
01185       imagettes=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imagette_8c.html#a14">IdImaConcat</a>(imagettes,ligne_imagettes);
01186 
01187       }
01188 
01189 <span class="keywordflow">if</span> (FLAG_COL)
01190       {
01191             ligne_imagettes =(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imagette_8c.html#a16">_IdImaCreImagetteClear</a> (&amp;tabimage[m], nx,k, XSIZE, YSIZE);
01192       imagettes=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imagette_8c.html#a14">IdImaConcat</a>(imagettes,ligne_imagettes);
01193       }
01194 
01195 <span class="keywordflow">return</span> imagettes;
01196 }
01197 
01198 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
01199 <span class="comment">* </span>
01200 <span class="comment">* IdImaMakeImagetteXYHoriz   (fonction)</span>
01201 <span class="comment">* </span>
01202 <span class="comment">* RESUME: Colle ds une matrice (G-&gt;D, H-&gt;B) des images les unes a la suite des autres</span>
01203 <span class="comment">* </span>
01204 <span class="comment">* DESCRIPTION:  Cree une imagette (matrice) a partir d'un tableau de pointeurs sur images.</span>
01205 <span class="comment">*     Les images sont 'rangees' de gauche a droite, puis de haut en bas.</span>
01206 <span class="comment">* </span>
01207 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= IdImaMakeImagetteXYHoriz (PPIMAGE_UCHAR tabImages[] , int nbImages, int nbImCol, int nbImLig, int Xsize, int Ysize);</span>
01208 <span class="comment">* </span>
01209 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01210 <span class="comment">*       type  : PPIMAGE_UCHAR *</span>
01211 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01212 <span class="comment">* </span>
01213 <span class="comment">*       nom   : nbImages </span>
01214 <span class="comment">*       type  : int </span>
01215 <span class="comment">*       role  : nb d'images ds le tableau</span>
01216 <span class="comment">* </span>
01217 <span class="comment">*       nom   : nbImCol</span>
01218 <span class="comment">*       type  : int </span>
01219 <span class="comment">*       role  : nombre d'imagettes (en X) par COLONNE (si -1, on ajuste)</span>
01220 <span class="comment">* </span>
01221 <span class="comment">*       nom   : nbImLig</span>
01222 <span class="comment">*       type  : int </span>
01223 <span class="comment">*       role  : nombre d'imagettes (en Y) par LIGNE (si -1, on ajuste)</span>
01224 <span class="comment">* </span>
01225 <span class="comment">*       nom   : Xsize </span>
01226 <span class="comment">*       type  : int </span>
01227 <span class="comment">*       role  : taille en X des images sous-echantillonnees</span>
01228 <span class="comment">* </span>
01229 <span class="comment">*       nom   : Ysize </span>
01230 <span class="comment">*       type  : int </span>
01231 <span class="comment">*       role  :  taille en Y des images sous-echantillonnees</span>
01232 <span class="comment">* </span>
01233 <span class="comment">* FICHIER:     imagette.c</span>
01234 <span class="comment">* </span>
01235 <span class="comment">* EXEMPLE:</span>
01236 <span class="comment">* </span>
01237 <span class="comment">******************************************************** END DESCRIPTION */</span>
01238 
<a name="l01239"></a><a class="code" href="imagette_8c.html#a18">01239</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a18">IdImaMakeImagetteXYHoriz</a> (
01240    PPIMAGE_UCHAR *tabimage,
01241    <span class="keywordtype">int</span> nb,     <span class="comment">// Number of images</span>
01242    <span class="keywordtype">int</span> XSIZE,  <span class="comment">// X-size of reduced images</span>
01243    <span class="keywordtype">int</span> YSIZE,  <span class="comment">// Y-size of reduced images</span>
01244    <span class="keywordtype">int</span> nx,     <span class="comment">// Number of images within each line</span>
01245    <span class="keywordtype">int</span> ny)     <span class="comment">// Number of images within each column</span>
01246 
01247 {
01248 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imagettes=NULL;       <span class="comment">/* image finale a retourner          */</span>
01249 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imin=NULL,imout=NULL;
01250 
01251 <span class="keywordtype">int</span>  k;
01252 <span class="keywordtype">int</span> i,j,l;
01253 
01254 <span class="keywordtype">int</span> nlp; <span class="comment">/* Nb de lignes pleines */</span>
01255 
01256 <span class="keywordtype">float</span> rapportx, rapporty;
01257 
01258      <span class="keywordflow">if</span> ( (nx!=-1)&amp;&amp;(ny!=-1) )  <span class="keywordflow">if</span> (nb&gt;(nx*ny))  
01259             {  nx=ny=(<span class="keywordtype">int</span>)ceil(sqrt((<span class="keywordtype">double</span>)nb));
01260                <span class="keywordflow">if</span> (nx*(ny-1)&gt;=nb) ny--;
01261             }
01262 
01263      <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny==-1) ) { nx=ny=(<span class="keywordtype">int</span>)ceil(sqrt((<span class="keywordtype">double</span>)nb));
01264             <span class="keywordflow">if</span> (nx*(ny-1)&gt;=nb) ny--;
01265             }
01266 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (ny==-1)&amp;&amp;(nx!=-1) ) { ny=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)nx) ); 
01267             }
01268 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny!=-1) ) { nx=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)ny) );  
01269             }
01270 
01271 <span class="keywordflow">if</span>(nb&lt;nx) k=nb; <span class="keywordflow">else</span> k=nx;
01272 
01273 
01274 imagettes= (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(nx*XSIZE, ny*YSIZE, <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
01275 
01276 <span class="keywordflow">if</span> (!imagettes)   { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Alloc imagettes\n"</span>);
01277        <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01278        <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01279       }
01280 
01281 <span class="keywordflow">if</span> (nb&lt;(nx*ny)) 
01282    { nlp=nb/nx;
01283     imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a0">IdImaAllocSubImage</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>) imagettes, 0,nlp , nx*XSIZE, (nx-nlp)*YSIZE);
01284    <a class="code" href="imaclear_8c.html#a1">IdImaClear</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imout);
01285    <a class="code" href="idima-calc_8h.html#a0">IdImaFreeSubImage</a>(imout);
01286    }
01287 
01288 imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a0">IdImaAllocSubImage</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>) imagettes, 0,0 , XSIZE, YSIZE);
01289 
01290 <span class="keywordflow">if</span> (!imout) {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Alloc sous-im\n"</span>); 
01291       <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01292       <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01293       }
01294 
01295 <span class="keywordflow">for</span> (l=0; l&lt;nb; l++)  <span class="comment">/* pour chaque image de la table */</span>
01296 {
01297 imin = tabimage[l];
01298 rapportx=((<span class="keywordtype">float</span>)(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imin)))/XSIZE;
01299 rapporty=((<span class="keywordtype">float</span>)(<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imin)))/YSIZE;
01300 
01301 imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a1">IdImaModifSubImage</a>( (<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imagettes, (<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imout, (l%nx)*XSIZE, (l/nx)*YSIZE);
01302 
01303 <span class="keywordflow">if</span> (!imout) {  <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Modif sous-im\n"</span>); 
01304       <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01305       <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01306       }
01307                                        
01308    <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a> (imout); j++)
01309            <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a> (imout); i++)                                             
01310    {
01311    imout[j][i]=((<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)imin)[(<span class="keywordtype">int</span>)(j*rapporty)][(<span class="keywordtype">int</span>)(i*rapportx)];
01312    }
01313 }
01314 
01315 <a class="code" href="idima-calc_8h.html#a0">IdImaFreeSubImage</a>(imout);
01316 <span class="keywordflow">return</span> imagettes;
01317 }
01318 
01319 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
01320 <span class="comment">* </span>
01321 <span class="comment">* IdImaMakeImagetteXYVertic   (fonction)</span>
01322 <span class="comment">* </span>
01323 <span class="comment">* RESUME: Colle ds une matrice ( H-&gt;B, G-&gt;D) des images les unes a la suite des autres</span>
01324 <span class="comment">* </span>
01325 <span class="comment">* DESCRIPTION:  Cree une imagette (matrice) a partir d'un tableau de pointeurs sur images.</span>
01326 <span class="comment">*     Les images sont 'rangees' de haut en bas , puis de gauche a droite.</span>
01327 <span class="comment">* </span>
01328 <span class="comment">* SYNTAXE:    PPIMAGE_UCHAR im8= IdImaMakeImagetteXYVertic (PPIMAGE_UCHAR tabImages[] , int nbImages, int nbImCol,int nbImLig,  int Xsize, int Ysize);</span>
01329 <span class="comment">* </span>
01330 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01331 <span class="comment">*       type  : PPIMAGE_UCHAR *</span>
01332 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01333 <span class="comment">* </span>
01334 <span class="comment">*       nom   : nbImages </span>
01335 <span class="comment">*       type  : int </span>
01336 <span class="comment">*       role  : nb d'images ds le tableau</span>
01337 <span class="comment">* </span>
01338 <span class="comment">*       nom   : nbImCol</span>
01339 <span class="comment">*       type  : int </span>
01340 <span class="comment">*       role  : nombre d'imagettes (en X) par COLONNE (si -1, on ajuste)</span>
01341 <span class="comment">* </span>
01342 <span class="comment">*       nom   :  nbImLig</span>
01343 <span class="comment">*       type  : int </span>
01344 <span class="comment">*       role  :  nombre d'imagettes (en Y) par LIGNE (si -1, on ajuste)</span>
01345 <span class="comment">* </span>
01346 <span class="comment">*       nom   : Xsize </span>
01347 <span class="comment">*       type  : int </span>
01348 <span class="comment">*       role  : taille en X des images sous-echantillonnees</span>
01349 <span class="comment">* </span>
01350 <span class="comment">*       nom   : Ysize </span>
01351 <span class="comment">*       type  : int </span>
01352 <span class="comment">*       role  :  taille en Y des images sous-echantillonnees</span>
01353 <span class="comment">* </span>
01354 <span class="comment">* FICHIER:     imagette.c</span>
01355 <span class="comment">* </span>
01356 <span class="comment">* EXEMPLE:</span>
01357 <span class="comment">* </span>
01358 <span class="comment">******************************************************** END DESCRIPTION */</span>
01359 
<a name="l01360"></a><a class="code" href="imagette_8c.html#a19">01360</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a19">IdImaMakeImagetteXYVertic</a> (
01361    PPIMAGE_UCHAR *tabimage,
01362    <span class="keywordtype">int</span> nb,     <span class="comment">// Number of images</span>
01363    <span class="keywordtype">int</span> XSIZE,  <span class="comment">// X-size of reduced images</span>
01364    <span class="keywordtype">int</span> YSIZE,  <span class="comment">// Y-size of reduced images</span>
01365    <span class="keywordtype">int</span> nx,     <span class="comment">// Number of images within each line</span>
01366    <span class="keywordtype">int</span> ny)     <span class="comment">// Number of images within each column</span>
01367 {
01368 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imagettes=NULL;       <span class="comment">/* image finale a retourner          */</span>
01369 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imin=NULL,imout=NULL;
01370 
01371 <span class="keywordtype">int</span>  k;
01372 <span class="keywordtype">int</span> i,j,l;
01373 
01374 <span class="keywordtype">int</span> nlp; <span class="comment">/* Nb de lignes pleines */</span>
01375 
01376   <span class="keywordtype">float</span> rapportx, rapporty;
01377 
01378      <span class="keywordflow">if</span> ( (nx!=-1)&amp;&amp;(ny!=-1) )  <span class="keywordflow">if</span> (nb&gt;(nx*ny))  
01379             {  nx=ny=(<span class="keywordtype">int</span>)ceil(sqrt((<span class="keywordtype">double</span>)nb));
01380               <span class="keywordflow">if</span> (nx*(ny-1)&gt;=nb) ny--;
01381             }
01382 
01383      <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny==-1) )   { nx=ny=(<span class="keywordtype">int</span>)ceil(sqrt((<span class="keywordtype">double</span>)nb));
01384                <span class="keywordflow">if</span> (nx*(ny-1)&gt;=nb) ny--;
01385             }
01386 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (ny==-1)&amp;&amp;(nx!=-1) ) { ny=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)nx) ); }
01387 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (nx==-1)&amp;&amp;(ny!=-1) ) { nx=(<span class="keywordtype">int</span>)ceil( ((<span class="keywordtype">double</span>)nb/(<span class="keywordtype">double</span>)ny) ); }
01388 
01389 
01390 <span class="keywordflow">if</span>(nb&lt;nx) k=nb; <span class="keywordflow">else</span> k=nx;
01391 
01392 imagettes= (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(nx*XSIZE, ny*YSIZE, <a class="code" href="idima-ido_8h.html#a1">IMA_UCHAR</a>);
01393 <span class="keywordflow">if</span> (!imagettes)   {
01394        <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Alloc Imagettes\n"</span>);
01395        <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01396        <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01397       }
01398 
01399 <span class="keywordflow">if</span> (nb&lt;(nx*ny)) 
01400    { nlp=nb/nx;
01401     imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a0">IdImaAllocSubImage</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>) imagettes, 0,nlp , nx*XSIZE, (nx-nlp)*YSIZE);
01402    <a class="code" href="imaclear_8c.html#a1">IdImaClear</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imout);
01403    <a class="code" href="idima-calc_8h.html#a0">IdImaFreeSubImage</a>(imout);
01404    }
01405 
01406 imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a0">IdImaAllocSubImage</a>( (<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imagettes, 0,0 , XSIZE, YSIZE);
01407 
01408 <span class="keywordflow">if</span> (!imagettes)   {
01409        <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Alloc sous-im\n"</span>);
01410        <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01411        <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01412       }
01413 
01414 <span class="keywordflow">for</span> (l=0; l&lt;nb; l++)  <span class="comment">/* pour chaque image de la table */</span>
01415 {
01416 imin = tabimage[l];
01417 rapportx=((<span class="keywordtype">float</span>)(<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imin)))/XSIZE;
01418 rapporty=((<span class="keywordtype">float</span>)(<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(imin)))/YSIZE;
01419 
01420 imout=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>) <a class="code" href="imapart_8c.html#a1">IdImaModifSubImage</a>((<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imagettes, (<a class="code" href="idima-ido_8h.html#a23">PPIMAGE</a>)imout, (l/ny)*XSIZE, (l%ny)*YSIZE);
01421 
01422 <span class="keywordflow">if</span> (!imout)    { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"Echec Modif sous-im\n"</span>); 
01423        <a class="code" href="iderr_8h.html#a65">IdErrno</a>=<a class="code" href="iderr_8h.html#a28">IDERR_ALLOC_IMA</a>;
01424        <span class="keywordflow">return</span> (<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)NULL;
01425       }
01426                                        
01427    <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a> (imout); j++)                                         
01428            <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a> (imout); i++)                                             
01429    {
01430    imout[j][i]=((<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)imin)[(<span class="keywordtype">int</span>)(j*rapporty)][(<span class="keywordtype">int</span>)(i*rapportx)];
01431    }
01432 }
01433 
01434 <a class="code" href="idima-calc_8h.html#a0">IdImaFreeSubImage</a>(imout);
01435 <span class="keywordflow">return</span> imagettes;
01436 }
01437 
01438 
01439 <span class="comment">/* FUNCTION DESCRIPTION **************************************************</span>
01440 <span class="comment">* </span>
01441 <span class="comment">* IdImaScotchImages   (fonction)</span>
01442 <span class="comment">* </span>
01443 <span class="comment">* RESUME: Colle en ligne des images les unes a la suite des autres</span>
01444 <span class="comment">* </span>
01445 <span class="comment">* DESCRIPTION:  Colle en ligne des images (de MEMES DIMENSIONS) les unes a la suite des autres</span>
01446 <span class="comment">*  </span>
01447 <span class="comment">* SYNTAXE:    PPIMAGE_USHORT im8= IdImaScotchImages (PPIMAGE_USHORT tabImages[],int nbImages);</span>
01448 <span class="comment">* </span>
01449 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01450 <span class="comment">*       type  : PPIMAGE_USHORT *</span>
01451 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01452 <span class="comment">* </span>
01453 <span class="comment">*       nom   : nbImages </span>
01454 <span class="comment">*       type  : int </span>
01455 <span class="comment">*       role  : nb d'images ds le tableau</span>
01456 <span class="comment">* </span>
01457 <span class="comment">* FICHIER:     imagette.c</span>
01458 <span class="comment">* </span>
01459 <span class="comment">* EXEMPLE:</span>
01460 <span class="comment">* </span>
01461 <span class="comment">******************************************************** END DESCRIPTION */</span>
01462 
<a name="l01463"></a><a class="code" href="imagette_8c.html#a20">01463</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a20">IdImaScotchImages</a>(
01464    PPIMAGE_UCHAR *TabImage,
01465    <span class="keywordtype">int</span> n)
01466 {
01467 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imagette;
01468 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> imaint;
01469 <span class="keywordtype">int</span> i,j,l,l1,NX,NY;
01470 
01471 NX=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(TabImage[0]);
01472 NY=<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(TabImage[0]);
01473 
01474 <span class="keywordflow">for</span> (l=1;l&lt;n;l++)
01475    { 
01476         <span class="keywordflow">if</span>(TabImage[l]==0)  { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur images : pointeur NULL\n"</span>);
01477                <span class="keywordflow">return</span> (0);
01478              }
01479    <span class="keywordflow">if</span>(<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(TabImage[l])!=NY)  { <a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"erreur tailles images\n"</span>);
01480                 <span class="keywordflow">return</span> (0);
01481                }
01482    }
01483 
01484 imagette=(<a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a>)<a class="code" href="imaallo_8c.html#a9">IdImaAlloc</a>(NX*n,NY,<a class="code" href="idgen_8h.html#a26">TY_UCHAR</a>);
01485 <span class="keywordflow">if</span>(!imagette) {<a class="code" href="kerprint_8c.html#a5">IdErrPrintf</a>(<span class="stringliteral">"echec allocation imagette\n"</span>); <span class="keywordflow">return</span> (NULL);}
01486 
01487 l1=0;
01488 <span class="keywordflow">for</span> (l=0;l&lt;n;l++)
01489    { 
01490       imaint=TabImage[l];
01491       <span class="keywordflow">for</span> (i=0;i&lt;NY;i++)
01492             {
01493          <span class="keywordflow">for</span> (j=0;j&lt;<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint);j++)
01494          {           
01495             imagette[i][l1+j]=imaint[i][j];  
01496          }
01497       }
01498       l1=l1+<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(imaint)*<a class="code" href="idgen_8h.html#a86">IdSizeOfType</a>(imagette); 
01499         }
01500    
01501 <span class="keywordflow">return</span>(imagette);
01502 }
01503 
01504 
01505 <span class="comment">/* FoNCTION DESCRIPTION **************************************************</span>
01506 <span class="comment">* </span>
01507 <span class="comment">* IdImaScotchImagesXYHoriz   (fonction)</span>
01508 <span class="comment">* </span>
01509 <span class="comment">* RESUME: Colle ds une matrice (G-&gt;D, H-&gt;B) des images les unes a la suite des autres</span>
01510 <span class="comment">* </span>
01511 <span class="comment">* DESCRIPTION:  Colle des images (de MEME TAILLE) dans une matrice</span>
01512 <span class="comment">*  Les images sont 'rangees' de gauche a droite, puis de haut en bas.</span>
01513 <span class="comment">* </span>
01514 <span class="comment">* SYNTAXE:    im8= IdImaScotchImagesXYHoriz (tabImages,nbImages,nbImCol,nbImLig);</span>
01515 <span class="comment">* </span>
01516 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01517 <span class="comment">*       type  : PPIMAGE_USHORT *</span>
01518 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01519 <span class="comment">* </span>
01520 <span class="comment">* PARAMETRES:  nom   : nbImages </span>
01521 <span class="comment">*       type  : int </span>
01522 <span class="comment">*       role  : nb d'images ds le tableau</span>
01523 <span class="comment">* </span>
01524 <span class="comment">*       nom   : nbImCol </span>
01525 <span class="comment">*       type  : int </span>
01526 <span class="comment">*       role  :  nombre d'imagettes par COLONNE (si -1, on ajuste)</span>
01527 <span class="comment">* </span>
01528 <span class="comment">*       nom   : nbImLig </span>
01529 <span class="comment">*       type  : int </span>
01530 <span class="comment">*       role  : nombre d'imagettes par LIGNE (si -1, on ajuste)</span>
01531 <span class="comment">* </span>
01532 <span class="comment">* FICHIER:     imagette.c</span>
01533 <span class="comment">* </span>
01534 <span class="comment">* EXEMPLE:</span>
01535 <span class="comment">* </span>
01536 <span class="comment">******************************************************** END DESCRIPTIoN */</span>
01537 
<a name="l01538"></a><a class="code" href="imagette_8c.html#a21">01538</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a21">IdImaScotchImagesXYHoriz</a> (
01539    PPIMAGE_UCHAR *tabimage,
01540    <span class="keywordtype">int</span> nb,     <span class="comment">// nb nombres d'images</span>
01541    <span class="keywordtype">int</span> nx,     <span class="comment">// nx nombre d'images par ligne</span>
01542    <span class="keywordtype">int</span> ny)     <span class="comment">// ny nombre d'images par colonne</span>
01543 
01544 {
01545 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> matImages=NULL;       <span class="comment">/* image finale a retourner          */</span>
01546 
01547 <span class="keywordtype">int</span> XSIZE, YSIZE;
01548 
01549 <span class="keywordtype">int</span> l;
01550 
01551 
01552 
01553 
01554 <span class="keywordflow">if</span> (!tabimage) {
01555       <span class="keywordflow">return</span> 0;
01556       }
01557 
01558 <span class="keywordflow">if</span> (nb&lt;=0)  {
01559       <span class="keywordflow">return</span> 0;
01560       }
01561 
01562 <span class="keywordflow">if</span> (tabimage[0] ==0) {
01563          <span class="keywordflow">return</span> 0;
01564          }
01565 
01566 XSIZE=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(tabimage[0]);
01567 YSIZE=<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(tabimage[0]);
01568 
01569 <span class="keywordflow">for</span> (l=1;l&lt;nb;l++)
01570  {
01571    <span class="keywordflow">if</span> (!<a class="code" href="imabasic_8c.html#a18">IdImaSameSizeAndType</a>(tabimage[0],tabimage[l]))   
01572       {
01573       <span class="keywordflow">return</span> 0;
01574       }
01575  }
01576 matImages=<a class="code" href="imagette_8c.html#a18">IdImaMakeImagetteXYHoriz</a> ( tabimage, nb, XSIZE, YSIZE, nx, ny);
01577 <span class="keywordflow">return</span> matImages;
01578 }
01579 
01580 
01581 
01582 <span class="comment">/* FoNCTION DESCRIPTION **************************************************</span>
01583 <span class="comment">* </span>
01584 <span class="comment">* IdImaScotchImagesXYVertic   (fonction)</span>
01585 <span class="comment">* </span>
01586 <span class="comment">* RESUME: Colle ds une matrice (H-&gt;B, G-&gt;D ) des images les unes a la suite des autres</span>
01587 <span class="comment">* </span>
01588 <span class="comment">* DESCRIPTION:  Colle des images (de MEME TAILLE) dans une matrice</span>
01589 <span class="comment">*  Les images sont 'rangees' de haut en bas, puis de gauche a droite.</span>
01590 <span class="comment">* </span>
01591 <span class="comment">* SYNTAXE:    im8= IdImaScotchImagesXYVertic (tabImages,nbImages,nbImCol,nbImLig);</span>
01592 <span class="comment">* </span>
01593 <span class="comment">* PARAMETRES:  nom   : tabImages </span>
01594 <span class="comment">*       type  : PPIMAGE_USHORT *</span>
01595 <span class="comment">*       role  : Pointeur vers le tableau d'images source</span>
01596 <span class="comment">* </span>
01597 <span class="comment">* PARAMETRES:  nom   : nbImages </span>
01598 <span class="comment">*       type  : int </span>
01599 <span class="comment">*       role  : nb d'images ds le tableau</span>
01600 <span class="comment">* </span>
01601 <span class="comment">*       nom   : nbImCol </span>
01602 <span class="comment">*       type  : int </span>
01603 <span class="comment">*       role  :  nombre d'imagettes par COLONNE (si -1, on ajuste)</span>
01604 <span class="comment">* </span>
01605 <span class="comment">*       nom   : nbImLig </span>
01606 <span class="comment">*       type  : int </span>
01607 <span class="comment">*       role  : nombre d'imagettes par LIGNE (si -1, on ajuste)</span>
01608 <span class="comment">* </span>
01609 <span class="comment">* FICHIER:     imagette.c</span>
01610 <span class="comment">* </span>
01611 <span class="comment">* EXEMPLE:</span>
01612 <span class="comment">* </span>
01613 <span class="comment">******************************************************** END DESCRIPTIoN */</span>
01614 
01615 
<a name="l01616"></a><a class="code" href="imagette_8c.html#a22">01616</a> <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> <a class="code" href="imagette_8c.html#a22">IdImaScotchImagesXYVertic</a> (
01617    PPIMAGE_UCHAR *tabimage,
01618    <span class="keywordtype">int</span> nb,     <span class="comment">// nb nombres d'images</span>
01619    <span class="keywordtype">int</span> nx,     <span class="comment">// nx nombre d'images par ligne</span>
01620    <span class="keywordtype">int</span> ny)     <span class="comment">// ny nombre d'images par colonne</span>
01621 
01622 {
01623 <a class="code" href="idima-ido_8h.html#a25">PPIMAGE_UCHAR</a> matImages=NULL;       <span class="comment">/* image finale a retourner          */</span>
01624 
01625 <span class="keywordtype">int</span> XSIZE, YSIZE;
01626 
01627 <span class="keywordtype">int</span> l;
01628 
01629 
01630 
01631 
01632 <span class="keywordflow">if</span> (!tabimage) {
01633       <span class="keywordflow">return</span> 0;
01634       }
01635 
01636 <span class="keywordflow">if</span> (nb&lt;=0)  {
01637       <span class="keywordflow">return</span> 0;
01638       }
01639 
01640 <span class="keywordflow">if</span> (tabimage[0] ==0) {
01641          <span class="keywordflow">return</span> 0;
01642          }
01643 
01644 XSIZE=<a class="code" href="imabasic_8c.html#a5">IdImaDimX</a>(tabimage[0]);
01645 YSIZE=<a class="code" href="imabasic_8c.html#a4">IdImaDimY</a>(tabimage[0]);
01646 
01647 <span class="keywordflow">for</span> (l=1;l&lt;nb;l++)
01648  {
01649    <span class="keywordflow">if</span> (!<a class="code" href="imabasic_8c.html#a18">IdImaSameSizeAndType</a>(tabimage[0],tabimage[l]))   
01650       {
01651       <span class="keywordflow">return</span> 0;
01652       }
01653  }
01654 matImages=<a class="code" href="imagette_8c.html#a19">IdImaMakeImagetteXYVertic</a> ( tabimage, nb, XSIZE, YSIZE, nx, ny);
01655 <span class="keywordflow">return</span> matImages;
01656 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 20 14:28:14 2006 for SIMRI3D by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
